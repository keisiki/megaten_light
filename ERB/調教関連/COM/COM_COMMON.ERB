;-------------------------------------------------
;共通판정
;N 통상のCOM呼び出し経路でCALLTRAIN時以外は潰して無印まで活かせない
;D DOTRAINの経路で、CALLTRAINフラグを潰してから판정させる
;無印 実際の処理はここで行う
;-------------------------------------------------
@COM_ABLE_COMMON_N, ARG
SIF !TFLAG:CALLTRAIN
	RETURN 0
CALL COM_ABLE_COMMON, ARG
RETURN RESULT

;DOTRAIN用　CALLTRAINフラグを折ってから체크に入る
;DOTRAINを이용する場合、これで판정させること
@COM_ABLE_COMMON_D, ARG
TFLAG:CALLTRAIN = 0
CALL COM_ABLE_COMMON, ARG
RETURN RESULT

@COM_ABLE_COMMON, ARG
SIF ARG < 0 ||ARG > 1008
	RETURN 0

;필터판정
IF FLAG:필터토오루過설정
	SIF GET_COM_FILTERING(ARG, TARGET)
		RETURN 0
	SELECTCASE ARG
		CASE IS < 20
			SIF CFLAG:TARGET:애무계필터
				RETURN 0
		CASE IS < 40
			SIF CFLAG:TARGET:커뮤계필터
				RETURN 0
		CASE IS < 50
			SIF CFLAG:TARGET:도구계필터
				RETURN 0
		CASE IS < 60
			SIF CFLAG:TARGET:대조교자도구계필터
				RETURN 0
		CASE IS < 67
			SIF CFLAG:TARGET:∨성교계필터
				RETURN 0
		CASE IS < 80
			SIF CFLAG:TARGET:Ａ성교계필터
				RETURN 0
		CASE IS < 90
			SIF CFLAG:TARGET:봉사계필터
				RETURN 0
		CASE IS < 100
			SIF CFLAG:TARGET:조교자봉사계필터
				RETURN 0
		CASE IS < 120
			SIF CFLAG:TARGET:ＳＭ계필터
				RETURN 0
		CASE IS < 140
			SIF CFLAG:TARGET:조수・레즈계필터
				RETURN 0
		CASE IS < 160
			SIF CFLAG:TARGET:하드계필터
				RETURN 0
		CASE IS < 180
			SIF CFLAG:TARGET:촉수계필터
				RETURN 0
		CASEELSE
			SIF CFLAG:TARGET:특수커맨드필터
				RETURN 0
	ENDSELECT
ENDIF

LOCAL = 0
;個別판정
TRYCCALLFORM CHECK_COM_ABLE{ARG}
	LOCAL = RESULT
CATCH
	LOCAL = 0
ENDCATCH

RETURN LOCAL



;-------------------------------------------------
;共通実行
;-------------------------------------------------
@COM_COMMON,ARG

LOCAL = 0
TRYCCALLFORM ACT_COM{ARG}
	LOCAL = RESULT
CATCH
	LOCAL = 0
ENDCATCH

RETURN LOCAL

