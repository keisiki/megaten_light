;=======================================================================
;도쿄타워
;던전ナンバー27　ＭＡＰ0~2
;フラグ
;던전フラグ:27:1  クリアフラグ
;던전フラグ:27:10 突入フラグ　BIT:1　初回　BIT:10　愛城華恋初回（クリアフラグ前）　BIT:11　愛城華恋初回（クリアフラグ後）
;던전フラグ:27:11 魔女の去就（0～9：전투前・전투中　11：魔女を助けた　12：魔女を助けた＋加入　13：メシア教が占拠　14：ファントムが占領）
;던전フラグ:27:12 SCP-191加入フラグ
;던전フラグ:27:13 かれひか観光フラグ　BIT:1水族館　BIT:2お土産屋　BIT:3展望台　BIT:4東京タワーの主に挨拶　BIT:5かれひか観光完了
;
;外部ファイル
;이벤트フラグ:93:1　BIT演算:3　1=愛城華恋이벤트3
;이벤트フラグ:93:1　BIT演算:4　1=愛城華恋이벤트4
;
;=======================================================================
;
;元ネタは여신転生2における魔女の居城としての東京タワー
;ただし内部구조はオリジナルに
;だって元のマップめたくそ狭いんだもん
;
;=======================================================================
;更新履歴
;=======================================================================
;日付　　　　　主犯　　　　　　　　更新内容
;2019/10/25　　(ﾟдﾟ)　　　　　　　新規作成
;2020/02/12　　(ﾟдﾟ)　　　　　　　バルドルを뮤턴트に差し替え
;
;=======================================================================
;攻略조건
;=======================================================================
@PREREQUISITE_DUNGEON_27
;東京タワーを制圧せよ　を通過済み
SIF 이벤트フラグ:49:0
	RETURN 1
RETURN 0



;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_27
RESULTS = 도쿄타워


;=======================================================================
;フ로어名표시
;=======================================================================
@FLOORNAME_27
PRINT 도쿄타워
SELECTCASE FLAG:現M
	CASE 0
		PRINTL 東京タワー周辺
	CASE 1
		PRINTL タワービル
	CASE 2
		PRINTL メインデッキ
	CASE 3
		PRINTL トップデッキ
	CASE 4
		PRINTL ？？？
	CASEELSE
		PRINTL ？？？？？
ENDSELECT

;=======================================================================
;スタート地点입력
;=======================================================================
@START_DUNGEON_27,ARG
FLAG:現M = 0
FLAG:現X = 7
FLAG:現Y = 8
;CALL AUTOMAP

;=======================================================================
;攻略開始時の이벤트
;=======================================================================
@EVENT_DUNGEON_START_27
CALL SHOW_PICTURE, "D"
IF GETBIT(던전フラグ:27:10,1) == 0
	IF 이벤트フラグ:49:0 == 1
		CALL MESSAGE_WINDOW_D, "", "＞メシア教の의뢰を受けた당신は、現場へと발を踏み入れた。/＞既に信者たちが住民と小競り合いをしているようだ……"
	
	ELSEIF 이벤트フラグ:49:0 == 2
		CALL MESSAGE_WINDOW_D, "", "＞당신は、幾重にも張られた結界を抜けて、東京タワー周辺までたどり着いた。/＞ボロ小屋や廃ビルの中から、怯えたような눈線が、幾つもこちらを見つめている……"
	
	ELSEIF 이벤트フラグ:49:0 == 3
		CALL MESSAGE_WINDOW_D, "", "＞당신がたどり着いたとき、既に東京タワー周辺は、無数の천사に囲まれていた。/＞당신は殺意を漲らせ적地の中へと突入した。"
	ENDIF
	
	;突入フラグON
	SETBIT 던전フラグ:27:10,1
ENDIF


;クリアフラグが立っている
IF 던전フラグ:27:1 && GETBIT(던전フラグ:27:10,11) == 0
	;かれひか揃い
	IF FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
		CALL MESSAGE_WINDOW_D, "", "＞東京タワーを見上げた舞台소녀たちが悲しげな顔をしている"
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "私たちの知ってる東京タワーとは……違うね"
		CALL MESSAGE_WINDOW_D, "히카리", "わかり切っていたことでしょ/何をいまさら言っているの/……お願いします、この子に、現実を見せてあげて"
		CALL MESSAGE_WINDOW_D, "", "＞당신は適当に返事をした/＞さびれた水族館跡でも見せてやれば現実が見えるだろう……"
		
		SETBIT 던전フラグ:27:11,1
		SETBIT 던전フラグ:27:10,1
		
	;華恋しか居ない（※水族館入れません）
	ELSEIF FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "これが東京タワー……なの？"
		CALL MESSAGE_WINDOW_D, "", "＞당신は適当に返事をした/＞神楽ひかりを連れて来ていないのが心配だが、/＞まあ、さびれた水族館跡でも見せてやれば現実が見えるだろう……"
		
	;ひかりしか居ない（※水族館入れません）
	ELSEIF FINDCHARA_B([[キャラ:히카리]]) == 2
		CALL MESSAGE_WINDOW_D, "히카리", "私だけ連れて来られても、困る"
		CALL MESSAGE_WINDOW_D, "", "＞ひかりは辛そうに눈を伏せている/＞変わり果てた東京タワーを、直視したくないのだろう"
	ENDIF
	
;クリアフラグが立ってない
ELSEIF GETBIT(던전フラグ:27:10,10) == 0
	SIF FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "東京……タワー……？"
	SIF FINDCHARA_B([[キャラ:히카리]]) == 2
		CALL MESSAGE_WINDOW_D, "히카리", "東京タワーが……東京タワーが……"
	
	IF FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 || FINDCHARA_B([[キャラ:히카리]]) == 2
		CALL MESSAGE_WINDOW_D, "", "＞いけない、夢見る舞台소녀が、/＞厳しい現実に白눈を剥き始めた"
		CALL MESSAGE_WINDOW_D, "", "＞당신は、ショックでがくがく痙攣し始めた소녀に/＞『とりあえず今日は仕事を손伝ってくれ』とだけ念押し、/＞取り落としてしまった무기を握らせ直した"
		;愛城華恋突入フラグON
		SETBIT 던전フラグ:27:10,10
	ENDIF
	
ENDIF


;=======================================================================
;탈출時の이벤트
;=======================================================================
@EVENT_DUNGEON_END_27
;던전탈출時、クリアフラグが立っていない
IF !던전フラグ:27:1
	;魔女を殺害＆メシア教の의뢰を受けている場合、賞金と名声GET
	IF 던전フラグ:27:11 == 13 && 이벤트フラグ:49:0 == 1
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", @"＞賞金首・東京タワーの魔女を討伐した/＞입座に￥25000が支払われ、名声20を得た"
		;ちょっとロウに変動
		CFLAG:MASTER:秩混치 += 16
		MONEY += 25000
		FLAG:名声 += 20
		던전フラグ:27:1 = 1
	;魔女を殺害＆의뢰は受けてない場合、名声だけGET
	ELSEIF 던전フラグ:27:11 == 13 && 이벤트フラグ:49:0 == 2
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", @"＞東京タワーの魔女を討伐した당신の소문は裏の社会で大きく広がった/＞名声30を得た/＞ファントムから特別褒賞金が25,000円支給された"
		MONEY += 30000
		FLAG:名声 += 30
		;ここでファントム占領フラグを立てる
		던전フラグ:27:11 = 14
		던전フラグ:27:1 = 1
	;魔女を助けた＆メシア教を潰しに来た
	ELSEIF 던전フラグ:27:11 == 11 && 이벤트フラグ:49:0 == 3
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", @"＞メシア教の精鋭を返り討ちにした당신の評判は瞬く間に広がった/＞名声を30得た"
		;ちょっとカオスに偏る
		CFLAG:MASTER:秩混치 -= 16
		FLAG:名声 += 30
		던전フラグ:27:1 = 1
	;魔女を助けただけだと特に何も得られない
	ELSEIF 던전フラグ:27:11 == 11
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", @"＞당신は東京タワーの魔女に見送られながらその場を後にした……"
		던전フラグ:27:1 = 1
	ENDIF
	
;クリアフラグが立っていて、かつ東京タワー観光が終了している
ELSEIF GETBIT(던전フラグ:27:13,5) == 0 && GETBIT(던전フラグ:27:13,4)
	CALL SHOW_PICTURE, "D"
	CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん"
	CALL MESSAGE_WINDOW_D, "히카리", "……なに、카렌（무대소녀）"
	CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "また、ここから、始めよう/また一緒に舞台をしよう/新しい私たちで、今度こそ、スタァライトの舞台に立とう！"
	CALL MESSAGE_WINDOW_D, "히카리", "叶わないかも、知れないのよ/舞台ばかりしているわけにもいかない/戦いの中で、取り返しのつかない눈に遭うかもしれない/……あの人の気分を損ねて離れ離れにされるかもしれない"
	CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ノンノン、舞台소녀は日々進化中！/私たちはどんどん強くなる！　お芝居もじゃんじゃん上손になる！/それに、私たちは何度だって舞台に立つ。立たない訳がないよ。だって……"
	CALL MESSAGE_WINDOW_D, "", "＞華恋は、僅かにほほ笑んだ/　そして凛々しい笑顔でひかりと――당신に笑い掛けた"
	CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "どんなことがあったって、/舞台にかける情熱は、無くせるものじゃないんだから！"
	CALL MESSAGE_WINDOW_D, "히카리", "카렌（무대소녀）……당신は"
	CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "だから約束！/また、ここから始めよう/二人で一緒に、みんなで一緒に、続けよう！　무대소녀！"
	CALL MESSAGE_WINDOW_D, "", "＞高らかな愛城華恋の宣言と、/　未だ複雑な笑みを浮かべる神楽ひかり/＞당신は、輝き出した舞台소녀を伴って、/　いつもより鮮やかに見える東京タワーを後にした……"

	;ちょっとスタァライトされる
	CFLAG:MASTER:善悪치 += 32
	
	LOCAL:0 = GETCHARA([[キャラ:히카리]])
	;だいぶスタァライトされる
	CFLAG:(LOCAL:0):善悪치 += 64
	
	SETBIT 던전フラグ:27:13,5

ENDIF
;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@CAN_ENTER_27,ARG,ARG:1
CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;フ로어데이터
;=======================================================================
@MAKE_FLOOR_27
SELECTCASE FLAG:現M
	CASE 0
	;東京タワー周辺
		FLAG:최대X = 19
		FLAG:최대Y = 19

;								           1         2
;								 012345678901234567890
		CALL MAKE_FLOOR_LINE,0, "                    "
		CALL MAKE_FLOOR_LINE,1, " 111111111111111111 "
		CALL MAKE_FLOOR_LINE,2, " 111111 11111  1  1 "
		CALL MAKE_FLOOR_LINE,3, " 1  411 11111     1 "
		CALL MAKE_FLOOR_LINE,4, " 1  11   1111111111 "
		CALL MAKE_FLOOR_LINE,5, " 11111 6 4111111111 "
		CALL MAKE_FLOOR_LINE,6, " 1  4114111111   11 "
		CALL MAKE_FLOOR_LINE,7, " 1  4111111111 4 11 "
		CALL MAKE_FLOOR_LINE,8, " 111111111111111111 "
		CALL MAKE_FLOOR_LINE,9, "       8            "
		;1　通路
		;2　扉
		;3　箱
		;4　メッセンジャー
		;6　昇り階段
		;7　下り怪談
		;8　出입
		
		
		
	CASE 1
	;タワービル
		FLAG:최대X = 9
		FLAG:최대Y = 9
;								 012345678
		CALL MAKE_FLOOR_LINE,0, "         "
		CALL MAKE_FLOOR_LINE,1, " 1411123 "
		CALL MAKE_FLOOR_LINE,2, " 11 2   "
		CALL MAKE_FLOOR_LINE,3, "    1111"
		CALL MAKE_FLOOR_LINE,4, " 6    17 "
		CALL MAKE_FLOOR_LINE,5, " 1112111 "
		CALL MAKE_FLOOR_LINE,6, " 2 2 111 "
		CALL MAKE_FLOOR_LINE,7, " 4 4 111 "
		CALL MAKE_FLOOR_LINE,8, "         "
		
	CASE 2
	;メインデッキ
		FLAG:최대X = 9
		FLAG:최대Y = 9
;								 012345678
		CALL MAKE_FLOOR_LINE,0, "         "
		CALL MAKE_FLOOR_LINE,1, " 141 4 6 "
		CALL MAKE_FLOOR_LINE,2, " 111 114 "
		CALL MAKE_FLOOR_LINE,3, " 111 333 "
		CALL MAKE_FLOOR_LINE,4, " 7116    "
		CALL MAKE_FLOOR_LINE,5, " 1111123 "
		CALL MAKE_FLOOR_LINE,6, "  1      "
		CALL MAKE_FLOOR_LINE,7, " 3111123 "
		CALL MAKE_FLOOR_LINE,8, "         "
	CASE 3
	;トップデッキ
		FLAG:최대X = 9
		FLAG:최대Y = 9
;								 012345678
		CALL MAKE_FLOOR_LINE,0, "         "
		CALL MAKE_FLOOR_LINE,1, " 3 11117 "
		CALL MAKE_FLOOR_LINE,2, " 33 1  1 "
		CALL MAKE_FLOOR_LINE,3, "    1  1 "
		CALL MAKE_FLOOR_LINE,4, " T  7111 "
		CALL MAKE_FLOOR_LINE,5, " 2 3  14 "
		CALL MAKE_FLOOR_LINE,6, " 1 2   2 "
		CALL MAKE_FLOOR_LINE,7, " 4211111"
		CALL MAKE_FLOOR_LINE,8, "         "
		
		
		;이벤트の設置
		;@SET_TILE,X座標, Y座標, 사용するフラグ, フラグがいくつのときにタイルを設置するか, 設置するタイル
		;つまり、これはX座標1、Y座標7の位置に、던전フラグ:27:11が0のときのみ、IDが300番の、4（이벤트）を置く
		;この4004は マップ番号である4*1000 + タイルの종류を表す4で構成されています。
		;CALL SET_TILE, 1 , 7 , 던전フラグ:27:11 , 0 , 3014
		
		;魔女を助けた場合、ヘソクリ部屋해방
		CALL SET_TILE, 1 , 3 , 던전フラグ:27:11 , 11 , 3001
		
		;なお、던전フラグ:27:11は던전フラグ:{FLAG:現던전}:11や、던전フラグ:[[던전:에코빌딩]]:11という記述もできます
		;기본的には前者권장、던전の外やほかの던전からフラグを見たいときは後者もいいでしょう
		
		
		
	CASE 4
	;いまんとこ用途なし
		FLAG:최대X = 9
		FLAG:최대Y = 9
;								 012345678
		CALL MAKE_FLOOR_LINE,0, "         "
		CALL MAKE_FLOOR_LINE,1, " 1111111 "
		CALL MAKE_FLOOR_LINE,2, " 1111111 "
		CALL MAKE_FLOOR_LINE,3, " 1111111 "
		CALL MAKE_FLOOR_LINE,4, " 1111111 "
		CALL MAKE_FLOOR_LINE,5, " 1111111 "
		CALL MAKE_FLOOR_LINE,6, " 1111111 "
		CALL MAKE_FLOOR_LINE,7, " 1111111 "
		CALL MAKE_FLOOR_LINE,8, "         "
		
	CASEELSE
	;いまんとこ用途なし
		FLAG:최대X = 9
		FLAG:최대Y = 9
;								 012345678
		CALL MAKE_FLOOR_LINE,0, "         "
		CALL MAKE_FLOOR_LINE,1, " 1111111 "
		CALL MAKE_FLOOR_LINE,2, " 1111111 "
		CALL MAKE_FLOOR_LINE,3, " 1111111 "
		CALL MAKE_FLOOR_LINE,4, " 1111111 "
		CALL MAKE_FLOOR_LINE,5, " 1111111 "
		CALL MAKE_FLOOR_LINE,6, " 1111111 "
		CALL MAKE_FLOOR_LINE,7, " 1111111 "
		CALL MAKE_FLOOR_LINE,8, "         "


ENDSELECT

;=======================================================================
;タイル調整
;=======================================================================
;ARG:1、ARG:2はそれぞれX座標とY座標
;ARGはその座標に現在代入されている番号
;0：壁　1：床もしくは通路　2：扉　3：宝箱　4：이벤트　5：罠　6：上り階段 7：下り階段　8：出입　9：그외特殊処理等
;これらの内、3～9が代入されているマスに、個別の番号を与える処理を実行します。
;この処理を行った後、これらのマスには 「マップ番号*1000 + そのマスがそのマップで左上から数えて何個눈のARG타입のマスか*10 + ARG」が代入されます
;例えば 2003 であった場合、「2番のマップ＝３Ｆで、左上から数えて0個눈の3＝宝箱である」という事を意味しています
;尚、0～2はどのマップにも大量に設置されるので、ここでは기본的に個別の番号を与えません。
;
;何個눈のARG타입のマスなのか、は左上の(0,0)から右まで探し、その後一つ下の段に移って同様に探す、というのを右下まで繰り返して数えます。
@MAKE_FLOOR_LINE_COMMON_27, ARG, ARG:1, ARG:2
#LOCALSIZE 10
;LOCAL:0～9 それぞれ何個눈のARGなのかを記憶しています
;LOCAL:3 宝箱→사용フラグは던전フラグ:70~74
;指定された座標が(0,0)である場合、つまり新しいマップを読み込んだ時はLOCALを소거します
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
SELECTCASE ARG
	CASE 3
	
		IF GETBIT(던전フラグ:(FLAG:現던전):(FLAG:現M+70), LOCAL:3)
			DA:(ARG:1):(ARG:2) = 1
		ELSE
			DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:3 * 10 + 3
			LOCAL:3++
		ENDIF
	CASE 4 TO 9
		DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:ARG * 10 + ARG
		LOCAL:ARG++
	
ENDSELECT


;=======================================================================
;特殊タイル표시
;TILE_MARK_COMMON_{FLAG:現던전}_X
;=======================================================================
;ARG:1、ARG:2がX座標とY座標
;ARGはそこに代入されている値
;RESULTSに代入した文字がマップに표시されますが、必ず全角1文字分になるようにしてください。そうでないと표시が崩れます。

;이벤트タイル特殊표시
;末꼬리の_4は이벤트であることを示す4
@TILE_MARK_COMMON_27_4, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	;メッセンジャーを緑色で"ｍ"と표시
	CASE 0, 1, 2, 4, 5, 101, 102, 201, 202, 203, 205, 300, 301
		SETCOLOR 0x00ff00
		RESULTS = ｍ
	CASEELSE
		;特に설정しない場合、"！"と표시されます
		RETURN 1
ENDSELECT

;特殊タイルの표시
;末꼬리の_9は特殊タイルであることを示す9
@TILE_MARK_COMMON_27_9, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	CASE 300
		RESULTS = Ｔ
	CASEELSE
		;特に설정しない場合、"■"が표시されます
		RETURN 1
ENDSELECT

;=======================================================================
;[5]調べる　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_27

;==========
;出입の処理
;==========
IF DA:(FLAG:現X):(FLAG:現Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
;% 10は10で割ったあまり、つまり下一桁がでてきます
;そして、下一桁はタイルの종류を表す
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 3
	CALL TREASURE_27
	RETURN RESULT
;=======
;階段
;=======
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 6
	CALL UPSTAIRS_27
	RETURN RESULT

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 7
	CALL DOWNSTAIRS_27
	RETURN RESULT
;========
;이벤트
;========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 4
	SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
		;東京タワー周辺이벤트
		CASE 0
			;個人的に乗り込んで個人的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "다크서머너", "引継ぎは受けている、あとは任せておけ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "設備の搬入が大変です"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "男", "なんか、すげえ音がしたな/また姫様がミサイルをぶっ放したんだろうな、そうだろ？　ハハハ……"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "男", "おお、アンタか。姫様が会いたがってたぞ"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "男", "姫様に変なことをするんじゃないぞ"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "메시아교도", "落ち着いてください、/我々は、당신方を保護するために来たのです"
					CALL MESSAGE_WINDOW_D, "男", "嘘だ！　てめえら、姫様に何をする気だ！"
				
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "男", "ここは難民キャンプ……みたいなもんだよ/악마のせいで行き場のなくなった連中が、/姫様の庇護を求めて集まって来たんだ"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "男", "メシア教の連中が押し入ったんだ！/あんた、お願いだ、俺たちの姫様を助けてくれ！"
				ENDIF
			ENDIF
		CASE 1
			;自主的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "祈祷師", "話しかけるな/今、結界の調整をしてんのよ。손元が狂うだろ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "結界は順調に稼働しています/あの魔女は、まったく良いものを残してくれました。ハハハ"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "소년", "……あんた、何かやっただろ、クソっ"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "소년", "あ、ちぃーっす、姫さんは元気です/たまにミサイルが飛んでます"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "소년", "姫さんの結界、すげーよな/本人がいなくても、勝손に動き続けるんだ/風水파워ってやつ？"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "메시아교도", "東京タワーに張られていた結界は、こちらで해제しておきました/あとは、당신が頼りです、デビル・서머너"
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "소년", "ここは中立地오비なんだってさ/姫さんが、誰かのお告げで守ってるんだ/카오스？　とか、ロウ？　にも染まっちゃいけないんだってさ"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "소년", "ううっ……姫さんの結界が破られちまった……！"
				ENDIF
			ENDIF
		CASE 2
			;自主的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "다크서머너", "おい、隣のキチガイ、片づけてくれよ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "お隣さんは、よいメシア教徒でございます/きっと神の御許へと導かれることでしょう"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "女", "……早く出てって"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "女", "最近、アンタの話ばっかりするのよ、姫様が/さっきも、無駄にイルミネーションとか作ってたし/ぜったいハイになってるわアレ"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "女", "あっ、どろぼう猫！　よくも姫様を盗ったわね！/わたし好きだったのに"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "메시아교도", "반항적な者は後方に送っておきました/당신は早く魔女の身柄を！"
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "女", "姫様は強いのよ/この間も악마に、出合い머리にミサイルを叩きこんでいたわ"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "女", "あんたも姫様を狙ってきたのか！？/ちくしょう、帰れ！"
				ENDIF
			ENDIF
		CASE 4
			;自主的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "女", "みんな死ぬのよ！　破滅が来るのよ！/誰も逆らえない、逆らえないわ、アハハ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "魔女は神に逆らったから死んだのよ/魔女は弱くて愚かだったの、神の愛を知らなかったから/私があの子の魂を救ってあげなくちゃ……"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "女", "ねえ、なんでアンタ、ミサイルの臭いがするの？/姫様に追い返されたんでしょ？　ねえ？/そんなに血まみれなんだもの、ねえ！"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "女", "なんでアンタみたいなのが姫様の周りをうろちょろしてんのよ"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "女", "姫様に誤射されてない？/アハハ、冗談じゃなくて、マジのマジよ/結構見境ないんだから、あの子……"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "女", "今に姫様が、姫様があんたたちを皆殺しにしてくれる……"
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "女", "당신も姫様に戦いを？/アハハ！　체력には気を付けなさい、開幕ミサイルでごっそり持っていかれるわよ！"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "女", "ううっ、畜生、撃たれた/천사がアタシを撃ちやがった……"
				ENDIF
			ENDIF
		CASE 5
			;自主的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "다크서머너", "ガラクタばかりで、掃除が大変だよ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "ここに居た子達は、安全な教会に送ったわ。心配しないでね"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "아이たち", "大きな音がしたんだ、怖い、怖いよ"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "아이たち", "あ、この아이だの人だ、なんかちょーだい"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "아이たち", "最近姫様があんまり来てくれないの/당신は一緒に居るの？　恋人なの？"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "メシア教", "ここには아이たちが寄り集まって生活しているみたい/巻き込まれないように助けてあげなくちゃ……"
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "아이たち", "姫様、好きー！/お腹空いたときは、食べ物を分けてくれるんだ！"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "아이たち", "玄関は開けないよ！/誰が来ても開けちゃダメって、言われたもの！"
				ENDIF
			ENDIF
		;メインデッキ이벤트
		CASE 201
			;ほとんど隠しキャラ
			;限られたタイミング＆選択肢でしか仲間にならない
			;
			;魔女を殺したあと、クリアフラグが立った
			IF 던전フラグ:27:12
				CALL MESSAGE_WINDOW_D, "", "＞もう誰もいない"
			ELSEIF 던전フラグ:27:1 && (던전フラグ:(FLAG:現던전):11 == 14 || 던전フラグ:(FLAG:現던전):11 == 13)
				CALL MESSAGE_WINDOW_D, "", "＞生活感はあるが、誰もいない"
			;魔女を殺したあと、クリアフラグが立つ前に突入した
			ELSE
				;EX이벤트なしorネットワーク系이벤트불허가
				IF GETBIT(FLAG:EXTRA이벤트설정, 0) == 0 || GETBIT(FLAG:EXTRA이벤트필터, 9) == 1
					CALL MESSAGE_WINDOW_D, "", "＞生活感はあるが、誰もいない"
				ELSE
					CALL MESSAGE_WINDOW_D, "", "＞小柄な影が、粗末なベッドの上にうずくまっている……/＞아이카？/＞暗がりに居るせいでよく見えない"
					CALL INPUT_SELECT_D, "[0]見なかったことにする/[1]明かりで照らす"
					IF RESULT == 1
						CALL MESSAGE_WINDOW_D, "", "＞당신は아이を光で照らした"
						CALL MESSAGE_WINDOW_D, "아이", "……？"
						CALL MESSAGE_WINDOW_D, "", "＞ああ、恐らくは女児/＞歳のころは10に満たない程度か"
						CALL MESSAGE_WINDOW_D, "", "＞粗末な소매のない원피스だけを着て、/＞やや癖のある長いブロンドの머리카락を垂らしている"
						CALL MESSAGE_WINDOW_D, "", "＞そして、顔の左半分が……抉れていた"
						CALL MESSAGE_WINDOW_D, "아이", "……"
						CALL MESSAGE_WINDOW_D, "", "＞ちょうど、卵の殻でも剥いたみたいに/＞아이は、顔の左半分が抉れていた"
						CALL MESSAGE_WINDOW_D, "", "＞本来、愛らしい視線があるべきところを中心に、鋼のパーツが노출している/＞카메라・アイと思しき部分が、赤や緑に、蛍のように明滅している/＞팔や발も鋼の色がはみ出していた/＞耳を澄ますと、金属のすれる音が、聞こえていた"
						CALL MESSAGE_WINDOW_D, "", "＞머신種かとも思ったが/＞体臭は、幼い아이のそれであり、/＞傍らの변기の中には、コールタールのような便が溜まっていた"
						CALL MESSAGE_WINDOW_D, "아이", "……"
						CALL MESSAGE_WINDOW_D, "", "＞아이は憂鬱そうな顔で당신を見ている"
						CALL INPUT_SELECT_D, "お見合いしてても仕方がない、どうする？/[0]見なかったことにする/[1]持ち帰る"
						IF RESULT == 1
							CALL MESSAGE_WINDOW_D, "", "＞わざわざ魔女が匿っていた인간だ、持って帰って損にはなるまい"
							CALL MESSAGE_WINDOW_D, "", "＞당신は아이にコンタクトを取り、双方に적意が無いことを確認すると、/＞その鋼の손を引いてベッドの上から連れ出した"
							CALL MESSAGE_WINDOW_D, "", "＞ばさっ/＞何かが落ちた"
							CALL MESSAGE_WINDOW_D, "", "＞この冊子は……取説か？"
							CALL MESSAGE_WINDOW_D, "", "＞オブジェクト　SCP-191　が仲魔になった"
							CALL ADD_NEW_COMPANION,[[キャラ:SCP-191]],0
							SIF RESULT == 1
								CFLAG:(RESULT:1):전투참가불가능 = -1
							던전フラグ:27:12 = 1
						ELSE
							CALL MESSAGE_WINDOW_D, "", "＞당신は視線を外さないよう気を付けながら後ずさって離れた……"
						ENDIF
					ELSE
						CALL MESSAGE_WINDOW_D, "", "＞당신は視線を外さないよう気を付けながら後ずさって離れた……"
					ENDIF
					
					
				ENDIF
			ENDIF
		;トップデッキ이벤트
		CASE 300
			;自主的に魔女を殺した
			IF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "メカニック", "こら！　そこを跨ぐな！/まったく……전령を流すケーブルは踏むなよ、呪われるぞ"
			;魔女を殺し、クリアフラグが立っている
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 > 0
				CALL MESSAGE_WINDOW_D, "메시아교도", "もう我々の放送は御覧になられましたか？/いかがでしょう、信仰心が伝わりますか？"
			;魔女を殺した
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13
				CALL MESSAGE_WINDOW_D, "老婆", "デビル서머너に呪いあれ！"
			;魔女と同盟
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "老婆", "姫様に粗相のないようにするのだぞ"
			;魔女が加入
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "老婆", "お前が姫様を守るのだぞ"
			ELSE
				;メシア教の의뢰を受けた
				IF 이벤트フラグ:49:0 == 1
					CALL MESSAGE_WINDOW_D, "老婆", "ぐおお、こ、腰が……。/なんじゃ貴様、姫様には指一本触れさせぬぞ/消え失せーい！　消え失せ－い！"
				;メシア教の의뢰を断って個人的に来た
				ELSEIF 이벤트フラグ:49:0 == 2
					CALL MESSAGE_WINDOW_D, "老婆", "おのれ다크서머너風情が、姫様には指一本触れさせぬぞ/消え失せーい！　消え失せ－い！"
				;メシア教を潰しに来た
				ELSEIF 이벤트フラグ:49:0 == 3
					CALL MESSAGE_WINDOW_D, "老婆", "ぐおお、こ、腰が……。/なんじゃ貴様、姫様には指一本触れさせぬぞ/消え失せーい！　消え失せ－い！"
				ENDIF
			ENDIF
	ENDSELECT
ELSE
	CALL MESSAGE_WINDOW_D, "", "＞何も無いようだ"
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_27,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出입の処理
;==========
IF DA:(FLAG:現X):(FLAG:現Y) % 10 == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 3
	CALL TREASURE_27
	RETURN RESULT
;=======
;階段
;=======
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 6
	;水族館を見たあと、土産物屋に行っていない、かつ現Mが1
	IF GETBIT(던전フラグ:27:13,2) == 0 && GETBIT(던전フラグ:27:13,1) && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2 && FLAG:現M == 1
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃあん……"
		CALL MESSAGE_WINDOW_D, "히카리", "……すみません、카렌（무대소녀）、お土産屋も気になるみたいです/この階のどこかにあると思います"
		FLAG:現Y = 5
	;土産物屋を見たあと、展望台に行っていない、かつ現Mが2
	ELSEIF GETBIT(던전フラグ:27:13,3) == 0 && GETBIT(던전フラグ:27:13,2) && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2 && FLAG:現M == 2
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "展望台……"
		CALL MESSAGE_WINDOW_D, "히카리", "物欲しげな顔で見ないで"
		FLAG:現X = 3
	ELSE
		CALL UPSTAIRS_27
	ENDIF
	RETURN RESULT

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 7
	;水族館を見たあと、土産物屋に行っていない、かつ現Mが1
	IF GETBIT(던전フラグ:27:13,2) == 0 && GETBIT(던전フラグ:27:13,1) && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2 && FLAG:現M == 1
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃあん……"
		CALL MESSAGE_WINDOW_D, "히카리", "……すみません、一応、お土産屋も/この階のどこかにあると思います"
		FLAG:現Y = 5
	;土産物屋を見たあと、展望台に行っていない、かつ現Mが1
	ELSEIF GETBIT(던전フラグ:27:13,3) == 0 && GETBIT(던전フラグ:27:13,2) && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2 && FLAG:現M == 1
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "展望台……"
		CALL MESSAGE_WINDOW_D, "히카리", "物欲しげな顔で見ないで"
		FLAG:現X = 6
	;土産物屋を見たあと、展望台に行っていない、かつ現Mが2
	ELSEIF GETBIT(던전フラグ:27:13,3) == 0 && GETBIT(던전フラグ:27:13,2) && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2 && FLAG:現M == 2
		CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "展望台……"
		CALL MESSAGE_WINDOW_D, "히카리", "物欲しげな顔で見ないで"
		FLAG:現Y = 3
	ELSE
		CALL DOWNSTAIRS_27
	ENDIF
	RETURN RESULT

;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1


;========================
;이벤트
;========================
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 4
	SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
		;東京タワー周辺이벤트
		CASE 1
			RETURN 0
		CASE 3
			;個人的に来た場合はクリアフラグを立てるまで結解を自힘突破する필요有り
			IF 이벤트フラグ:49:0 == 2 && 던전フラグ:27:1 < 1
				
				CALL INPUT_SELECT_D, "特殊な結界が張られている……突破には全員のＨＰ・ＭＰを半分捧げる필요がある/[0]突入する /[1]引き下がる"
				IF RESULT == 0
					;自軍ＨＰ・ＭＰ반감
					FOR LOCAL,1,7
						IF POS(LOCAL) > -1 && GET_STATE(CFLAG:(POS(LOCAL)):ステート) != "DYING"
							PRINTFORML [{LOCAL}] %CALLNAME:POS(LOCAL)%　>>>>>>　{MAXBASE:(POS(LOCAL)):ＨＰ*50/100}ダメージ
							CALL VAR_HP,POS(LOCAL),-MAXBASE:(POS(LOCAL)):ＨＰ*50/100
							PRINTFORML [{LOCAL}] %CALLNAME:POS(LOCAL)%　>>>>>>　{MAXBASE:(POS(LOCAL)):ＭＰ*50/100}ダメージ
							CALL VAR_MP,POS(LOCAL),-MAXBASE:(POS(LOCAL)):ＭＰ*50/100
						ENDIF
					NEXT
					PRINTFORMW 당신は힘づくで結界を抉じ開けた
					
				ELSEIF RESULT == 1
					FLAG:現X = 7
					;上から来た
					IF ARG == 2
						FLAG:現Y -= 1
					;それ以外
					ELSE
						FLAG:現Y += 1
					ENDIF
					
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "", "結界が弱まっている……/당신は何事もなく障壁を通り抜けた"
			ENDIF
		;タワービル이벤트
		CASE 100
			;クリアフラグが立っていて、かつ、かれひかセット
			;かれひか観光フラグ・水族館が立ってない
			IF GETBIT(던전フラグ:27:13,1) == 0 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "", "＞東京タワー水族館……と看板はある"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ここ、が？"
				CALL MESSAGE_WINDOW_D, "", "＞だが、そこは真っ暗だ/＞空調の止まった部屋は埃っぽく、どことなく生臭い/＞死人のような空気が、部屋一杯に漂っていた"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "あはは、やってない、ね……"
				CALL MESSAGE_WINDOW_D, "", "＞華恋は、室内を見渡した"
				CALL MESSAGE_WINDOW_D, "히카리", "残念だけど、分かり切ってたこと"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "そう、だね"
				CALL MESSAGE_WINDOW_D, "히카리", "私たちはもう、違う세계に来てしまった/もう、あの세계には、戻れない/もう、あの舞台には……立てない"
				CALL MESSAGE_WINDOW_D, "", "＞華恋は、驚いた顔でひかりを見た/＞そして真검な顔で、彼女の눈を見つめた"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "違う、違うよ、それは違う/ここがどこだって、私が誰だって、関係ないよ"
				CALL MESSAGE_WINDOW_D, "히카리", "現実を見て……！/もう、私たちは、인간じゃない、舞台には立てない！/わがままを言わないで、この人を困らせないで/お願いだから、もう、大人になって"
				CALL MESSAGE_WINDOW_D, "", "＞ひかりはしばらく華恋を睨んだあと、踵を返して部屋を出た"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん、どうして？　どうしてそんなこと言うの？"
				CALL MESSAGE_WINDOW_D, "", "＞華恋はひかりを追った/＞途中、一瞬だけ水族館の跡地を悲しそうな눈で振り返ったあと/＞先に出たひかりの背中を追っていった"
				SETBIT 던전フラグ:27:13,1
				
			;クリアフラグ立ってない
			ELSEIF 던전フラグ:27:1 == 0
				CALL MESSAGE_WINDOW_D, "", "＞東京タワー水族館……と看板はある"
				CALL MESSAGE_WINDOW_D, "", "＞しかし、今は악마がたむろっているようだ/＞意味もなく近寄るのはやめておこう……"
				FLAG:現X = 3
				FLAG:現Y = 1
				
			ELSEIF GETBIT(던전フラグ:27:13,1) == 0 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2
				CALL MESSAGE_WINDOW_D, "", "＞東京タワー水族館……と看板はある"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "は、入れない……"
				CALL MESSAGE_WINDOW_D, "", "＞しかし、今日に限って、大量の악마がたむろしている/＞これを抉じ開けるのは難しい……"
				FLAG:現X = 3
				FLAG:現Y = 1
			ELSEIF GETBIT(던전フラグ:27:13,1) == 0 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "", "＞東京タワー水族館……と看板はある"
				CALL MESSAGE_WINDOW_D, "히카리", "……みえない"
				CALL MESSAGE_WINDOW_D, "", "＞しかし、今日に限って、大量の악마がたむろしている/＞これを抉じ開けるのは難しい……"
				FLAG:現X = 3
				FLAG:現Y = 1
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞東京タワー水族館……と看板はあるが、水槽は空っぽだ/この部屋には何もない"
			ENDIF
		CASE 101
			;クリアフラグが立っていて、かつ、かれひかセット
			;かれひか観光フラグ・水族館が立っていて、観光フラグ・売店が立ってない
			IF GETBIT(던전フラグ:27:13,2) == 0 && GETBIT(던전フラグ:27:13,1) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "잭프로스트", "ヒーホー！　東京タワー土産はどうだい！/今ならこの……あれ？　なんか雰囲気暗いね？　どったの？"
				CALL MESSAGE_WINDOW_D, "", "＞店員ごっこをしている잭프로스트が、/＞眉根を寄せて、愛城華恋を見上げている"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "あ、ヒーホーくんだ/ここって……？"
				CALL MESSAGE_WINDOW_D, "잭프로스트", "ここは売店！　オイラの売店！/ニンゲンが残したよく分からないものを売ってるんだホ！"
				CALL MESSAGE_WINDOW_D, "잭랜턴", "見つけたのオレだぞ"
				CALL MESSAGE_WINDOW_D, "", "＞照明係を兼ねている잭랜턴が鼻をほじりながら言った"
				CALL MESSAGE_WINDOW_D, "잭프로스트", "でも客が来ないんだホー"
				CALL MESSAGE_WINDOW_D, "잭랜턴", "来る訳ねえだろこんなとこ"
				
				;잭프로스트をスタァライトしてる
				IF GETBIT(이벤트フラグ:93:1, 20)
					CALL MESSAGE_WINDOW_D, "", "＞不意に、잭프로스트が動きを止めた/＞顎に손を当て、確かめるような눈で華恋を見つめる"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "どうしたの？"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "んー？/もしかして、キミ……/あの有名な“スタァライト”ちゃん？"
					CALL MESSAGE_WINDOW_D, "히카리", "は？"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "スタァライト……ちゃん……？"
					CALL MESSAGE_WINDOW_D, "", "＞華恋とひかりは少し考えたあと、/「あー！」と大きな声を上げた"
					CALL MESSAGE_WINDOW_D, "히카리", "あのときの、잭프로스트の모자のサイン！"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "確かに私、スタァライトしちゃいますって、書いた！"
					CALL MESSAGE_WINDOW_D, "잭랜턴", "え、マジ？/これがあの、お前ら３００人をまとめてダンスで負かしたっていう、/伝説のスタァライトちゃん？"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "マジマジ、マジだホ！/オイラたち３００人をまとめてダンスで蹴散らした……/伝説のスタァライトちゃん！"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "（どうしようひかりちゃん、話が大きくなってるよ……）"
					CALL MESSAGE_WINDOW_D, "히카리", "（だ、大丈남편、大丈남편よ/　私が守るって決めたもの/　何があっても大丈남편よ……！）"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "天下のスタァライトちゃんなら、今日のお代はサービスするホー！/好きなの何でも、프레젠트しちゃうホ！/そ・の・代・わ・り、オイラにもサインちょーだいネ"
					CALL MESSAGE_WINDOW_D, "잭랜턴", "おいおい、オレもだ！　オレも！/オレの모자の、この白いところによろしくな！"
					CALL MESSAGE_WINDOW_D, "", "＞２人は纏わりついて来る２体の요정にいろいろ勧められながら/＞店内をぐるりと一周した"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん、私、これがいいな"
					CALL MESSAGE_WINDOW_D, "히카리", "９色の東京タワー……/카렌（무대소녀）、당신"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "お土産だよ、私たち、みんなへの"
					CALL MESSAGE_WINDOW_D, "", "＞華恋は９つの小さな東京タワーを抱えたあと、/＞代金がわりに、彼らの모자へサインをしてあげた……"
					CALL MESSAGE_WINDOW_D, "잭랜턴", "へっへっへ、オレもスタァライトされちまった"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "オイラもみんなに自慢しよーっと/あ、そうだ、展望台も、一か所だけなら開いてるホ/思い出作りに昇ってくるといいホー"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ありがとう！"
					CALL MESSAGE_WINDOW_D, "히카리", "（잭프로스트……かわいい……）"
					CALL MESSAGE_WINDOW_D, "", "＞당신たちは、陽気な악마に見送られながらその場を後にした……"
				ELSE
					CALL MESSAGE_WINDOW_D, "", "＞잭랜턴の一言に、華恋がニッと歯を見せた"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "じゃあ、私たちが初めてのお客さんだね！"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "……あっ、お客さん？/お姉ちゃんたち、お客さん！？/は、初めてとは失礼な！　ひ・さ・し・ぶ・り！　久しぶりホー！"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "何を売ってるの？"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "なんかこの三角のペラペラ……"
					CALL MESSAGE_WINDOW_D, "잭랜턴", "バカ、それ以外もあるだろ/おいオマエ、着いてきな、在庫はたらふく用意してあるぜ"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "わーい"
					CALL MESSAGE_WINDOW_D, "히카리", "……止めなくて、良いんですか"
					CALL MESSAGE_WINDOW_D, "", "＞あの連中なら적意が無いと分かっている/＞당신は、ひかりも売店を見て回るように促した"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "カニハニワ、無いねー"
					CALL MESSAGE_WINDOW_D, "히카리", "ミスターホワイトも、スズダルキャットも……無い、ね"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "見たことない子ばっかりだね"
					CALL MESSAGE_WINDOW_D, "히카리", "知らないキャラクター、ばっかり、だね"
					CALL MESSAGE_WINDOW_D, "", "＞２人は少し複雑な顔をしていた/＞嬉しそうな악마たちを気遣ってか、입元こそは微笑んでいたが/＞視線は沈んでいた"
					CALL MESSAGE_WINDOW_D, "", "＞………………/＞…………/＞……"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "あ……！"
					CALL MESSAGE_WINDOW_D, "", "＞華恋が、パッと細い指を棚に向けた"
					CALL MESSAGE_WINDOW_D, "", "＞小さな東京タワーの置物だ/＞大きさは三十センチにも満たない、/＞しかし、色とりどりの、金属製の東京タワーだ"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん、私、これがいいな"
					CALL MESSAGE_WINDOW_D, "히카리", "９色の東京タワー……/카렌（무대소녀）、당신"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "お土産だよ、私たち、みんなへの"
					CALL MESSAGE_WINDOW_D, "", "＞ひかりは複雑な顔をしていたが、/＞華恋は真검な顔で、９色の東京タワーを、가슴に抱きしめた"
					CALL MESSAGE_WINDOW_D, "", "＞………………/＞…………/＞……"
					CALL MESSAGE_WINDOW_D, "잭프로스트", "まいどありー！"
					CALL MESSAGE_WINDOW_D, "", "＞なお、愛城華恋は日本円しか持っていなかったので、/＞마카は個人的なポケットマネーで立て替えた"
					CALL MESSAGE_WINDOW_D, "히카리", "すみません！　すみません！"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "あ、ありがとうございます/いやー、まさか普通のお金でお買い物できないなんて、あははー"
					CALL MESSAGE_WINDOW_D, "히카리", "카렌（무대소녀）！！！！！"
					CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ごめんなさい……"
					CALL MESSAGE_WINDOW_D, "", "＞잭프로스트いわく、展望台も１か所だけは使えるようになっているらしい/＞華恋は上の階に行こうとねだっている……"
					
				ENDIF
				SETBIT 던전フラグ:27:13,2
				
				;なにかここでLv30～40で使えそうな무기防具を販売したいけど리사ーチする時間がない
			ELSEIF GETBIT(던전フラグ:27:13,2)
				CALL MESSAGE_WINDOW_D, "잭프로스트", "ヒーホー！　東京タワー土産はどうだい！/この、なんか、三角のペラペラが、いまならたったの100マッカだホー"
				;CALL MESSAGE_WINDOW_D, "잭프로스트", "ヒーホー！　東京タワー土産はどうだい！/あんただったら、ちょーっとだけ、安くしてあげてもいいホ？"
				;$TTJB_SHOP
				;CALL INPUT_SELECT_D, "何か買うか？//[1]買う/[2]ステイタスを見る///[0]外に出る" , , , 2
				;IF RESULT == 1
				;	CALL MESSAGE_WINDOW_D , "잭프로스트" , "え？　戦いの道具が欲しい？　遊び心が발りないホー"
				;	;テストなう
				;	LOCALS = 
				;	LOCALS += "교복,10,"
				;	LOCALS += "수트,20,"
				;	LOCALS += "사립송례관학원교복,10,"
				;	LOCALS += "서바이벌베스트,15,"
				;	LOCALS += "레더부츠,5,"
				;	CALL DUNGEON_SHOPS, 1, LOCALS
				;	ELSEIF RESULT == 2
				;	CALL SHOP_COM_110
				;ELSE
				;	CALL MESSAGE_WINDOW_D , "잭프로스트" , "また来てねー！"
				;	CALL DUNGEON_WORP,1,1,7
				;	RETURN 1
				;ENDIF
				;GOTO TTJB_SHOP
			ELSE
				CALL MESSAGE_WINDOW_D, "잭프로스트", "ヒーホー！　東京タワー土産はどうだい！/この、なんか、三角のペラペラが、いまならたったの100マッカだホー"
				;$TTJB_SHOP
				;CALL INPUT_SELECT_D, "何か買うか？//[1]買う/[2]ステイタスを見る///[0]外に出る" , , , 2
				;IF RESULT == 1
				;	CALL MESSAGE_WINDOW_D , "잭프로스트" , "え？　戦いの道具が欲しい？　遊び心が발りないホー"
				;	;テストなう
				;	LOCALS = 
				;	LOCALS += "교복,10,"
				;	LOCALS += "수트,20,"
				;	LOCALS += "사립송례관학원교복,10,"
				;	LOCALS += "서바이벌베스트,15,"
				;	LOCALS += "레더부츠,5,"
				;	CALL DUNGEON_SHOPS, 1, LOCALS
				;	ELSEIF RESULT == 2
				;	CALL SHOP_COM_110
				;ELSE
				;	CALL MESSAGE_WINDOW_D , "잭프로스트" , "また来てねー！"
				;	CALL DUNGEON_WORP,1,1,7
				;	RETURN 1
				;ENDIF
				;GOTO TTJB_SHOP
				
			ENDIF
			
		CASE 102
			CALL MESSAGE_WINDOW_D, "엘프", "あ、侵入者。/見なかったことにするからさ、アンタも見逃してよ。/アタシ戦いとか嫌いなんだよねー、お金数えてる方が好き"
			
		;メインデッキ
		CASE 200
			IF GETBIT(던전フラグ:27:13,3) == 0 && GETBIT(던전フラグ:27:13,2) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "", "＞展望台から見渡すと、東京の景色が遠くまでよく見えた/＞당신にとっては見慣れた、色あせた、暗く淀んだ魔の都市だ"
				;朝
				IF TIME == 0
					CALL MESSAGE_WINDOW_D, "히카리", "早朝だっていうのに、景色が暗い/これが、악마に支配された세계/私たちが、これから、生きていかないといけない세계……"
				;昼
				ELSEIF TIME == 1
					CALL MESSAGE_WINDOW_D, "히카리", "こんな景色、知らない、こんな東京、分からない/これが、악마に支配された세계/私たちが、これから、生きていかないといけない세계……"
				;夕
				ELSEIF TIME == 2
					CALL MESSAGE_WINDOW_D, "히카리", "夕焼けが気持ち悪い色をしてる、まるで、血の色/これが、악마に支配された세계/私たちが、これから、生きていかないといけない세계……"
				;夜
				ELSEIF TIME == 3
					CALL MESSAGE_WINDOW_D, "히카리", "明かりが少ない。東京の夜景が、こんなに暗いの？/これが、악마に支配された세계/私たちが、これから、生きていかないといけない세계……"
				ENDIF
				CALL MESSAGE_WINDOW_D, "", "＞ひかりはショックを受けたのか、눈を見開いたまま固まってしまった/＞一方、愛城華恋は、キラキラと눈を輝かせて손すりを握り身体を눈一杯に乗り出している"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "んー、あれは롯폰기ヒルズですかなー？/じゃああっちが渋谷？/っていうことは……聖翔音楽学園は、あっちだね！"
				;聖翔の立地は校舎の元ネタに準拠
				CALL MESSAGE_WINDOW_D, "", "＞はしゃぐ華恋に、ひかりは「どうして」と声を上げた"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん？"
				CALL MESSAGE_WINDOW_D, "히카리", "どうして、どうして華恋はそう能天気なの/もう戻れないのよ、そこに、学校はもう無いのよ/私たちは……私たちは、偽物なのよ！？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "えええ……？"
				CALL MESSAGE_WINDOW_D, "히카리", "私たちはもう舞台소녀じゃない！　まともな인간ですらない！/악마を倒す道具として、필요だから生かされてるだけ！/それなのに華恋はずっと舞台のことばかり……/もう誰にも、歌もダンスも求められてないって言うのに！"
				CALL MESSAGE_WINDOW_D, "", "＞ひかりの言葉に、華恋の雰囲気が変わった/＞彼女は背筋を伸ばし、ひかりに向き直ると/＞真검な顔で、キラめく瞳でひかりを見つめた"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん、私たちは舞台소녀だよ"
				CALL MESSAGE_WINDOW_D, "히카리", "待っている舞台もないのよ！？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "ひかりちゃん、この세계に来たとき、私のためにスタァライトごっこしてくれたよね/私、嬉しかった/一瞬だけの、思い付きの、即興劇だったけど/私、すっごく元気が出た"
				CALL MESSAGE_WINDOW_D, "히카리", "あんなの、ただの、その場しのぎ/ただの、私たちの、自己満발"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "舞台がないなんて嘘っぱちだよ/私、あのスタァライトのつづきがしたい/私、ひかりちゃんの舞台が見たい"
				CALL MESSAGE_WINDOW_D, "히카리", "う……"
				CALL MESSAGE_WINDOW_D, "", "＞華恋が詰め寄り、ひかりがたじろぐ"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "うまく、言葉に、出来ないけれど/ひかりちゃん、/私が、ひかりちゃんの、舞台になるよ/だから、私と……！"
				CALL MESSAGE_WINDOW_D, "", "＞ひかりは、光り輝く瞳に耐えかね、唇を噛んで視線をそらした"
				CALL MESSAGE_WINDOW_D, "히카리", "……もうやめて/これ以上、私に、夢を見させないで"
				CALL MESSAGE_WINDOW_D, "", "＞華恋は、遠くまで続く東京の景色を背負ったまま、/　踵を返したひかりの背中に微笑んだ"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "待ってる、舞台で"
				CALL MESSAGE_WINDOW_D, "", "＞ひかりは逃げるように당신の影に隠れた"
				CALL MESSAGE_WINDOW_D, "히카리", "……バ華恋/そんなこと言われたら、/私までスタァライトしたくなるじゃない"
				CALL MESSAGE_WINDOW_D, "", "＞しばらく、당신たちは、展望台からの景色を無言で眺めた……"
				CALL MESSAGE_WINDOW_D, "히카리", "……はあ/そろそろ帰りましょう/あの子、放っておくと、いつまでもここに居ると思うから"
				CALL MESSAGE_WINDOW_D, "", "＞ひかりが言うほど、華恋は아이ではないように思えてきたが……/＞まあ、時間を浪費するのも宜しくない/＞要件も終わったことだ、最上階のターミナルから帰宅することとしよう"
				
				SETBIT 던전フラグ:27:13,3
			ELSE
				CALL MESSAGE_WINDOW_D, "", "ここの窓だけ補強されていない。/東京の景色が遠くまでよく見える……"
			ENDIF
		CASE 202
			;魔女が死んでる
			IF 던전フラグ:(FLAG:現던전):11 == 13 || 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "", "＞結界が張られていた痕跡がある/＞당신は注意して通り抜けた"
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞結界が張られている……これは突破できそうにない"
				FLAG:現X = 7
				FLAG:現Y = 1
			ENDIF
		;
		CASE 301
			
			;魔女を助けたけどクリアフラグが立ってない
			IF 던전フラグ:(FLAG:現던전):11 == 11 && 던전フラグ:(FLAG:現던전):1 < 1
				CALL MESSAGE_WINDOW_D, "魔女", "人助けついでに、このへん片づけるの손伝ってくれない？/ダメ？　あ、そ"
				RETURN 1
			;かれひか東京タワー観光済み＆魔女を助けてる
			ELSEIF GETBIT(던전フラグ:27:13,4) && 던전フラグ:(FLAG:現던전):11 == 11 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "魔女", "あんたたち、ホントに東京タワー好きね/いっそ住んだら？　部屋、空いてるわよ"
				CALL MESSAGE_WINDOW_D, "히카리", "やめてください、本気にする子がいるので"
				RETURN 1
			;かれひか東京タワー観光中＆魔女を助けてる
			ELSEIF (GETBIT(던전フラグ:27:13,4) == 0) && 던전フラグ:(FLAG:現던전):11 == 11 && GETBIT(던전フラグ:27:13,3) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "魔女", "あー？　なんか初めて見る子が居るわね、新손の악마？"
				CALL MESSAGE_WINDOW_D, "히카리", "……似たようなものです/お邪魔してます、騒がしくして済みません"
				CALL MESSAGE_WINDOW_D, "魔女", "はいどーも、悪さしないなら、それなりに歓迎するわ"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "初めまして！　愛城華恋です！/魔女さんは東京タワーに住んでるんですか？"
				CALL MESSAGE_WINDOW_D, "魔女", "……住んでんのよ、文句ある？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "わー、いいなー！/私、東京タワー大好きなんです！/あっ、こっちは私の友達のひかりちゃん"
				CALL MESSAGE_WINDOW_D, "魔女", "あ、そう"
				CALL MESSAGE_WINDOW_D, "히카리", "……すみません、すぐ帰りますので"
				CALL MESSAGE_WINDOW_D, "魔女", "どうぞご勝손に/こっちも、お茶もお菓子も出せないしさ/まあ、東京タワーも、別に私のもんじゃないし、/악마さえ怖くないならまた来たらいいわ"
				CALL MESSAGE_WINDOW_D, "", "＞魔女は후드を深くかぶり直し、面倒くさそうにシッシと손を振った"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "おじゃましましたー！"
				CALL MESSAGE_WINDOW_D, "魔女", "はいはい！/やったら元気ね、あの子……/ふん、무대소녀、舞台소녀ねえ……"
				
				SETBIT 던전フラグ:27:13,4
				RETURN 1
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11 && 이벤트フラグ:49:0 == 2
				CALL MESSAGE_WINDOW_D, "魔女", "奥のヘソクリ部屋、開けておいたわ/この間のお礼よ"
				CALL SET_TILE, 1 , 3 , 던전フラグ:27:11 , 11 , 3001
				RETURN 1
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 11
				CALL MESSAGE_WINDOW_D, "魔女", "また来たの？　アンタ暇なの？"
				CALL SET_TILE, 1 , 3 , 던전フラグ:27:11 , 11 , 3001
				RETURN 1
				
			;魔女加入後
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 12
				CALL MESSAGE_WINDOW_D, "", "＞結界を稼働させるための魔法陣が煌々と輝いている……"
				RETURN 1
				
			;メシア教が占拠かつクリアまだ
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:(FLAG:現던전):1 < 1
				CALL MESSAGE_WINDOW_D, "", "ここにはもう血だまりしかない"
				RETURN 1
			;かれひか東京タワー観光済み＆メシア教の의뢰を受けた
			ELSEIF GETBIT(던전フラグ:27:13,4) && 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "카즈펠", "舞台、舞台かあ/私も何か、即興劇でも放送してみようかしら……？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "グッドグッドです！/천사さま、良い声してるもん！　きっといい舞台になります！"
			
				RETURN 1
			;かれひか東京タワー観光中＆メシア教の의뢰を受けた
			ELSEIF (GETBIT(던전フラグ:27:13,4) == 0) && 던전フラグ:(FLAG:現던전):11 == 13 && GETBIT(던전フラグ:27:13,3) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "카즈펠", "ああ、ファントムの서머너さん、先日はありがとうございました。/そちらの可愛らしい方々は？/見たところ……随分と華やかなお姿ですが"
				CALL MESSAGE_WINDOW_D, "", "＞どんな如何わしい想像をしているのか、カズフェルはその美しい眉を怒りの形に歪めた"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "初めまして、愛城華恋です！/당신は、ええと……천사さま？/お話はお伺いしてます！"
				CALL MESSAGE_WINDOW_D, "", "＞ニコニコと笑う華恋を見て毒気を抜かれたか、/　カズフェルはきょとんとした顔で소녀を見た"
				CALL MESSAGE_WINDOW_D, "카즈펠", "あ……いいえ、こちらこそ失礼致しました/당신たちは、その……善良そうね？/私はカズフェル、このメシア放送局の管理者です/당신たちは？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "はい！/私たちは聖翔音楽学園、９９期生、……舞台소녀です！"
				CALL MESSAGE_WINDOW_D, "카즈펠", "舞台……？　女優さんなの？"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "はい！　といっても、まだまだ未熟ですけど、にへへ"
				CALL MESSAGE_WINDOW_D, "", "＞당신はカズフェルに彼女たちの出自を補발した"
				CALL MESSAGE_WINDOW_D, "카즈펠", "……？/きりん……？"
				CALL MESSAGE_WINDOW_D, "", "＞しまった、キリンの話は余計だったか/＞カズフェルは머리の上にクエスチョンマークを浮かべて固まった"
				CALL MESSAGE_WINDOW_D, "히카리", "ごめんなさい、でも、本当のことなんです"
				CALL MESSAGE_WINDOW_D, "카렌（무대소녀）", "今はこの人のところでお世話になってます！"
				CALL MESSAGE_WINDOW_D, "카즈펠", "ま、まあ、大変な境遇にあることは分かりました/辛いことがあったらいつでもいらっしゃいね/神はいつでも、救いの道を用意してございますから……"
				CALL MESSAGE_WINDOW_D, "", "＞カズフェルは、당신に「悪の道には引き込まないで」とクギを刺しつつ/　舞台소녀を笑顔と握손で見送った……"
				
				SETBIT 던전フラグ:27:13,4
				RETURN 1
			;メシア教が占拠＆의뢰を受けた
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 이벤트フラグ:49:0 == 1
				CALL MESSAGE_WINDOW_D, "美しい소녀", "ああ、ファントムのデビル서머너さん/先日は邪悪な魔女の討伐、ありがとうございます/おかげで神の御心を人々に直接届けられるようになりました……"
				RETURN 1
			;メシア教が占拠
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 13 && 이벤트フラグ:49:0 == 1
				CALL MESSAGE_WINDOW_D, "美しい소녀", "どうして……당신は魔女を討伐してくださったのですか？/의뢰は受けないと聴いていたのに"
				RETURN 1
				
			;かれひか東京タワー観光済み＆ファントムが占領
			ELSEIF GETBIT(던전フラグ:27:13,4) && 던전フラグ:(FLAG:現던전):11 == 13 && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "ファントム構成員", "あっ、その子が例の舞台소녀ですか？/へえー、確かに可愛い顔してるわ/そっちに置いておくのは勿体ないというか適任というか……"
			
				RETURN 1
			;かれひか東京タワー観光中＆ファントムが占領
			ELSEIF (GETBIT(던전フラグ:27:13,4) == 0) && 던전フラグ:(FLAG:現던전):11 == 14 && GETBIT(던전フラグ:27:13,3) && 던전フラグ:27:1 && FINDCHARA_B([[キャラ:카렌（무대소녀）]]) == 2 && FINDCHARA_B([[キャラ:히카리]]) == 2
				CALL MESSAGE_WINDOW_D, "ファントム構成員", "あっ、その子が例の舞台소녀ですか？/へえー、確かに可愛い顔してるわ/そっちに置いておくのは勿体ないというか適任というか……"
			
				SETBIT 던전フラグ:27:13,4
				RETURN 1
			;ファントムが占領
			ELSEIF 던전フラグ:(FLAG:現던전):11 == 14
				CALL MESSAGE_WINDOW_D, "ファントム構成員", "せっかくの電波塔です、こちらで有効活用してみせます/……ええと、テレビに映ってたら、応援してくださいね？"
				RETURN 1
				
			ENDIF
			
			CALL SHOW_PICTURE, "D"
			;メシア教の의뢰を受けた
			IF 이벤트フラグ:49:0 == 1
				CALL MESSAGE_WINDOW_D, "", "＞深く후드を被った소녀が、천사の死体の上に立っている。"
				CALL MESSAGE_WINDOW_D, "魔女", "まずいわね、こんどはデビル서머너か……/あんたファントム？　メシア教に電波塔を渡すつもり？/あのバカどもにデカい顔をさせても良いってわけ？"
				CALL INPUT_SELECT_D, "ただならぬ気配だ……どうする？/[0]退却する /[1]戦う"
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "魔女", "賢明ね。去る者は追わないわ"
					FLAG:現X = 3
					FLAG:現Y = 7
					RETURN 1
					
				ELSE
				
					CALL MESSAGE_WINDOW_D, "魔女", "ふん、組織のイヌめ/……천사ごとやっつけてやるわ、食らえ！"
					CALL MESSAGE_WINDOW_D, "", "魔女はミサイルを発射した！"
					;自軍HP반감
					FOR LOCAL,1,7
						IF POS(LOCAL) > -1 && GET_STATE(CFLAG:(POS(LOCAL)):ステート) != "DYING"
							PRINTFORML [{LOCAL}] %CALLNAME:POS(LOCAL)%　>>>>>>　{MAXBASE:(POS(LOCAL)):ＨＰ*50/100}ダメージ
							CALL VAR_HP,POS(LOCAL),-MAXBASE:(POS(LOCAL)):ＨＰ*50/100
						ENDIF
					NEXT
					WAIT
					CALL MESSAGE_WINDOW_D, "", "/＞초인 東京タワーの魔女が１体出た！/" , , , , , , , , , "CENTER"
					
					
					FLAG:도주불가フラグ = 1
					FLAG:회화불능フラグ = 1
					FLAG:선제기습취소 = 1
					CALL SET_ENEMY,9,[[キャラ:도쿄타워의마녀]],34,0,1
					CFLAG:(CHARANUM-1):行動횟수 = 2
					CFLAG:(CHARANUM-1):ＨＰ보정 += 500
					
					;초인扱いに
					ABL:(CHARANUM-1):종족 = 43
					CSTR:(CHARANUM-1):종족명 = 초인
					
					;뉴클리어밤を100％落とす
					ABL:(CHARANUM-1):아이템1 = 1112
					ABL:(CHARANUM-1):입수확률1 = 100
					;마하・지온가のカードを50％落とす
					ABL:(CHARANUM-1):아이템2 = 10905
					ABL:(CHARANUM-1):입수확률2 = 50
					;뉴클리어미사일の스킬카드を5％落とす
					ABL:(CHARANUM-1):아이템3 = 11905
					ABL:(CHARANUM-1):입수확률3 = 5
					
					ABL:(CHARANUM-1):스킬1 = [[스킬:마구패기]]
					ABL:(CHARANUM-1):스킬2 = [[스킬:스파크볼트]]
					ABL:(CHARANUM-1):스킬3 = [[스킬:마린카린]]
					ABL:(CHARANUM-1):스킬4 = [[스킬:플래시봄]]
					ABL:(CHARANUM-1):스킬5 = [[스킬:해피트리거]]
					ABL:(CHARANUM-1):스킬6 = [[스킬:도루미나]]
					ABL:(CHARANUM-1):스킬7 = [[스킬:라이트블래스트]]
					ABL:(CHARANUM-1):스킬8 = 0
				
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)		
					CALL BATTLE_START
					FLAG:도주불가フラグ = 0
					FLAG:회화불능フラグ = 0
					FLAG:선제기습취소 = 0
					CALL SHOW_PICTURE, "D"
					CALL MESSAGE_WINDOW_D, "魔女", "守らなくちゃ、いけなかったのに"
					CALL MESSAGE_WINDOW_D, "", "/＞초인 東京タワーの魔女は힘尽きた/" , , , , , , , , , "CENTER"
					
					CALL ADD_NEW_COMPANION,[[キャラ:도쿄타워의마녀]],0
					
					CALL MESSAGE_WINDOW_D, "","＞당신は魔女の死体を袋に詰めた/＞蘇生させれば使い道はいくらでもあるだろう"
					CALL MESSAGE_WINDOW_D, "","＞奴隷　東京タワーの魔女を손に入れた"
					
					던전フラグ:27:11 = 13
					
					RETURN 1
				
				ENDIF
				
			;メシア教の의뢰を断って個人的に来た
			ELSEIF 이벤트フラグ:49:0 == 2
				CALL MESSAGE_WINDOW_D, "", "＞魔法陣の上に、深く후드を被った소녀が立っている"
				CALL MESSAGE_WINDOW_D, "魔女", "結界を破って入って来たのはアンタね。/メシア？　가이아？　/悪いことは言わないわ、今すぐに立ち去りなさい"
				
				CALL INPUT_SELECT_D, "ただならぬ気配だ……どうする？/[0]退却する /[1]戦う/[2]話がしたいので무기を置く"
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "魔女", "賢明ね。去る者は追わないわ"
					FLAG:現X = 3
					FLAG:現Y = 7
					RETURN 1
					
				ELSEIF RESULT == 1
					
					CALL MESSAGE_WINDOW_D, "魔女", "あら、やる気なんだ。なら……/くたばれッ！"
					CALL MESSAGE_WINDOW_D, "", "魔女はミサイルを発射した！"
					;自軍HP반감
					FOR LOCAL,1,7
						IF POS(LOCAL) > -1 && GET_STATE(CFLAG:(POS(LOCAL)):ステート) != "DYING"
							PRINTFORML [{LOCAL}] %CALLNAME:POS(LOCAL)%　>>>>>>　{MAXBASE:(POS(LOCAL)):ＨＰ*50/100}ダメージ
							CALL VAR_HP,POS(LOCAL),-MAXBASE:(POS(LOCAL)):ＨＰ*50/100
						ENDIF
					NEXT
					WAIT
					CALL MESSAGE_WINDOW_D, "", "/＞초인 東京タワーの魔女が１体出た！/" , , , , , , , , , "CENTER"
					
					
					FLAG:도주불가フラグ = 1
					FLAG:회화불능フラグ = 1
					FLAG:선제기습취소 = 1
					CALL SET_ENEMY,9,[[キャラ:도쿄타워의마녀]],34,0,1
					CFLAG:(CHARANUM-1):行動횟수 = 2
					CFLAG:(CHARANUM-1):ＨＰ보정 += 500
					
					;초인扱いに
					ABL:(CHARANUM-1):종족 = 43
					CSTR:(CHARANUM-1):종족명 = 초인
					
					;自힘で結界をぶち割ってきた場合は스킬카드のドロップ率爆増
					;뉴클리어밤を100％落とす
					ABL:(CHARANUM-1):아이템1 = 1112
					ABL:(CHARANUM-1):입수확률1 = 100
					;마하・지온가のカードを50％落とす
					ABL:(CHARANUM-1):아이템2 = 10905
					ABL:(CHARANUM-1):입수확률2 = 100
					;뉴클리어미사일の스킬카드を50％落とす
					ABL:(CHARANUM-1):아이템3 = 11905
					ABL:(CHARANUM-1):입수확률3 = 50
					
					ABL:(CHARANUM-1):스킬1 = [[스킬:마구패기]]
					ABL:(CHARANUM-1):스킬2 = [[스킬:스파크볼트]]
					ABL:(CHARANUM-1):스킬3 = [[스킬:마린카린]]
					ABL:(CHARANUM-1):스킬4 = [[스킬:플래시봄]]
					ABL:(CHARANUM-1):스킬5 = [[스킬:해피트리거]]
					ABL:(CHARANUM-1):스킬6 = [[스킬:도루미나]]
					ABL:(CHARANUM-1):스킬7 = [[스킬:라이트블래스트]]
					ABL:(CHARANUM-1):스킬8 = 0
					ABL:(CHARANUM-1):스킬9 = 0
					ABL:(CHARANUM-1):스킬10 = 0
					ABL:(CHARANUM-1):스킬11 = 0
					ABL:(CHARANUM-1):스킬12 = 0
					
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL BATTLE_START
					FLAG:도주불가フラグ = 0
					FLAG:회화불능フラグ = 0
					FLAG:선제기습취소 = 0
					CALL SHOW_PICTURE, "D"
					CALL MESSAGE_WINDOW_D, "魔女", "守らなくちゃ、いけなかったのに"
					CALL MESSAGE_WINDOW_D, "", "/＞초인 東京タワーの魔女は힘尽きた/" , , , , , , , , , "CENTER"
					
					CALL ADD_NEW_COMPANION,[[キャラ:도쿄타워의마녀]],0
					
					CALL MESSAGE_WINDOW_D, "","＞このぐらいなら도반옥で甦る/＞당신は魔女の死体を袋に詰めた"
					CALL MESSAGE_WINDOW_D, "","＞奴隷　東京タワーの魔女を손に入れた"
					던전フラグ:27:11 = 13
					
					;タイルをただの床に
					;DA:(FLAG:現X):(FLAG:現Y) = 1
					
				ELSEIF RESULT == 2
					
					CALL MESSAGE_WINDOW_D, "魔女", "んん？　変な反応ね、アタシがやる気だったらどうするの？/ま아이いわ、その姿勢は嫌いじゃない/何か聞きたいの？"
					
					;直近の返答を記憶するため
					LOCAL:0 = 0
					$INPUT_MAJO_KAIWA
					CALL INPUT_SELECT_D, "[0]東京タワーで何を？ /[1]誰の命令でこんなことを？ /[2]仲間は居ないの？ /[3]聞きたいことは無い、伝えたいことがある "
					IF RESULT == 0
						IF GETBIT(LOCAL:0,2)
							CALL MESSAGE_WINDOW_D, "魔女", "아이かっ！　しつこいと殴るわよ！"
							SETBIT LOCAL:0,3
						ELSEIF GETBIT(LOCAL:0,1)
							CALL MESSAGE_WINDOW_D, "魔女", "はいはい、しつこいわね/そうよ、ここには霊脈がある。攻めるに難く守るに易し……/そのうえ、ここからの電波は関東一円に届く/だから、変な思想の連中には絶対に渡せない、それだけよ"
							SETBIT LOCAL:0,2
						ELSE
							CALL MESSAGE_WINDOW_D, "魔女", "……住んでるのよ/あー、道義に反してるのは分かってる、テナント料も払ってない/でもアンタは家主じゃない。他は？"
							SETBIT LOCAL:0,1
						ENDIF
						
						GOTO INPUT_MAJO_KAIWA
					ELSEIF RESULT == 1
						IF GETBIT(LOCAL:0,5)
							CALL MESSAGE_WINDOW_D, "魔女", "これ以上は言えないわ/守秘義務ってわけじゃないの/まあ、お告げみたいなものよ。だから答えられない"
							;STEVENを想定
							SETBIT LOCAL:0,6
						ELSEIF GETBIT(LOCAL:0,4)
							CALL MESSAGE_WINDOW_D, "魔女", "あー、ここら辺に住んでる人は、アタシが勝손に保護してるだけ/幸いお金も物資も困ってないから、ついでよ、ついで/……ここ、危ないから、落ち着いたら出て行けって言ってるんだけどね"
							SETBIT LOCAL:0,5
						ELSE
							CALL MESSAGE_WINDOW_D, "魔女", "【체크맨】って知ってる？　トーテムポールみたいなやつ/아이つら越しに、ちょっとね/アタシの仕事はここを中立に保つこと。他は？"
							SETBIT LOCAL:0,4
						ENDIF
						
						GOTO INPUT_MAJO_KAIWA
					ELSEIF RESULT == 2
						IF GETBIT(LOCAL:0,8)
							CALL MESSAGE_WINDOW_D, "魔女", "ええい、誰がボッチですか！/しつこいとミサイルぶつけるわよ！？"
							SETBIT LOCAL:0,9
						ELSEIF GETBIT(LOCAL:0,7)
							CALL MESSAGE_WINDOW_D, "魔女", "周囲の악마は奥のターミナルで召喚しているわ/アタシが설정したわけじゃないからアタシも止められない/殺されても文句言わないでね？"
							SETBIT LOCAL:0,8
						ELSE
							CALL MESSAGE_WINDOW_D, "魔女", "ご覧の通りよ、文句ある？/一人でこんだけやってんだから、운命の王子様ぐらい居てもいいのにね……/他は？"
							SETBIT LOCAL:0,7
						ENDIF

						GOTO INPUT_MAJO_KAIWA
					ELSEIF RESULT == 3
						
						IF GETBIT(LOCAL:0,3) && GETBIT(LOCAL:0,6) && GETBIT(LOCAL:0,9)
							CALL MESSAGE_WINDOW_D, "魔女", "はー、それが本題？　ずいぶん遠回りしたわね……。/アンタ、話好き？/別にいいけど"
						ENDIF
						CALL MESSAGE_WINDOW_D, "", "＞당신はメシア教が襲撃を企てていることを魔女に伝えた"
						CALL MESSAGE_WINDOW_D, "魔女", "ふうん、それをわざわざ？　アタシの結界をブチ割ってまで？/物好きね、アンタ。/ま아이いわ、忠告通り、주살トラップでも満載にしておく"
						CALL MESSAGE_WINDOW_D, "", "魔女は何かごそごそと準備を始めた……"
						CALL MESSAGE_WINDOW_D, "魔女", "そのうち、また来なさい/襲撃が本当で、かつ、アタシが生き残ってたら/何かお礼をしてあげるわ"
						던전フラグ:27:11 = 11

					ENDIF
					
					
					
				ENDIF
					
					
			;メシア教を潰しに来た
			ELSEIF 이벤트フラグ:49:0 == 3
				CALL MESSAGE_WINDOW_D, "魔女", "くっ……頑丈なのね、천사ってヤツは！"
				CALL MESSAGE_WINDOW_D, "", "＞魔法陣の上に、深く후드を被った소녀が膝を突いている。/＞周囲には複数の천사と、それを従える美しい乙女が立っていた。"
				CALL MESSAGE_WINDOW_D, "메시아교도", "邪悪なり、도쿄타워의마녀/당신の存在は、むやみに争いを煽るだけ……/神の愛を阻むものに、容赦など致しません"
				CALL MESSAGE_WINDOW_D, "", "＞당신は二人に聞こえるように、部屋の壁をコンコンとノックした"
				CALL MESSAGE_WINDOW_D, "魔女", "新손？　デビル・서머너か！"
				CALL MESSAGE_WINDOW_D, "메시아교도", "……あら？　당신は、ファントムの？/今更来ても報酬は出せませんよ/お引き取りください"
				
				CALL MESSAGE_WINDOW_D, "", "この乙女、顔こそ清楚で美しいが、見た눈通りの気配ではない。당신の返事は――"
				CALL INPUT_SELECT_D, "[0]ファントムは安売りしない、報いを受けろ/[1]눈的は何？/[2]えっ、かわいい"
				
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "메시아교도", "……は？　安く見られた報い、ですか？/本当に、ただそれだけのために？　ここまで沢山の命を蹴散らして？"
					CALL MESSAGE_WINDOW_D, "메시아교도", "度し難い……あまりにも野蛮すぎる……！"
				
				ELSEIF RESULT == 1
					;原作のアレ
					CALL MESSAGE_WINDOW_D, "메시아교도", "당신は、この荒れた東京を見て、どう感じた？/無秩序に악마が暴れ、人の営みを脅かす、この東京……/今もたくさんの人々が、明日の見えない공포におののいている……"
					CALL MESSAGE_WINDOW_D, "메시아교도", "今こそ、神の救いの손が、필요だと思うでしょう？"
					CALL INPUT_SELECT_D, "メシア教徒の소녀は真검なまなざしで당신を見ている……/[0]共感は出来るが、立場上同意できない /[1]メシア教は嫌い、反吐が出る /[2]知らんがな"
					
					IF RESULT == 0
						CFLAG:MASTER:善悪치 += 16
						CFLAG:MASTER:秩混치 += 16
						CALL MESSAGE_WINDOW_D, "메시아교도", "입では何とでも言えるわ/……でも、形だけでも共感してくれるのは嬉しい/당신とは違う形で出会いたかった"
					ELSEIF RESULT == 1
						CFLAG:MASTER:善悪치 -= 16
						CFLAG:MASTER:秩混치 -= 16
						CALL MESSAGE_WINDOW_D, "메시아교도", "……당신も所詮、ただの傭兵ね"
					ELSEIF  RESULT == 2
						CALL MESSAGE_WINDOW_D, "메시아교도", "は！？/あ、당신が訊いて来たのに……！"
					ENDIF
					
				ELSEIF RESULT == 2
					CALL MESSAGE_WINDOW_D, "메시아교도", "は！？/そういう冗談は嫌いです"
					CALL MESSAGE_WINDOW_D, "魔女", "アンタ何なの誰よ何しに来たの！？/こっちは大変なのよ！？　バカなの死ぬの！？"
					CALL MESSAGE_WINDOW_D, "", "＞솔직함な感想を述べただけなのに双方から怒られた/＞당신は肩をすくめた"
				ENDIF
				
				CALL MESSAGE_WINDOW_D, "메시아교도", "――お喋りはここまでです"
				CALL MESSAGE_WINDOW_D, "", "＞メシア教徒の身体が光に包まれる"
				CALL MESSAGE_WINDOW_D, "", "＞次の瞬間、三対の黄金の翼をもつ이형の천사が、당신を睨み付けていた！"
				
				CALL MESSAGE_WINDOW_D, "", "/＞천사　カズフェルが１体出た！/" , , , , , , , , , "CENTER"
				
				SETCOLOR 0xff0033
				PRINTFORML 
				PRINTFORML ┏＞카즈펠━━━━━━━━━━━━━━━━━━━━━━┓
				PRINTFORML ┃　　　　　　　　　　　　　　　　　　　　　　　　　　　　┃
				PRINTFORML ┃　　　これ以上、神の御心に逆らうことは、許さん！　　　　┃
				PRINTFORML ┃　　　　　　　　　　　　　　　　　　　　　　　　　　　　┃
				PRINTFORMW ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
				RESETCOLOR
				
				FLAG:도주불가フラグ = 1
				FLAG:회화불능フラグ = 1
				FLAG:선제기습취소 = 1
				CALL SET_ENEMY,9,[[キャラ:카즈펠]],35,0,1
				CFLAG:(CHARANUM-1):行動횟수 = 2
				CFLAG:(CHARANUM-1):ＨＰ보정 += 2250
				
				;회전설법の스킬카드を5％落とす
				ABL:(CHARANUM-1):아이템3 = 11320
				ABL:(CHARANUM-1):입수확률3 = 5
				
				ABL:(CHARANUM-1):스킬1 = [[스킬:고양의노래]]
				ABL:(CHARANUM-1):스킬2 = [[스킬:마하・잔마]]
				ABL:(CHARANUM-1):스킬3 = [[스킬:갈라]]
				ABL:(CHARANUM-1):스킬4 = [[스킬:마린카린]]
				ABL:(CHARANUM-1):스킬5 = [[스킬:라쿠・카쟈]]
				ABL:(CHARANUM-1):스킬6 = 0
				ABL:(CHARANUM-1):스킬7 = 0
				ABL:(CHARANUM-1):스킬8 = 0
				
				;비구弱点のままだと速攻落とされてしまうので……ｗ
				MAXBASE:(CHARANUM-1):비구 = 100
				BASE:(CHARANUM-1):비구 = 100
				
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)		
				CALL BATTLE_START
				FLAG:도주불가フラグ = 0
				FLAG:회화불능フラグ = 0
				FLAG:선제기습취소 = 0
				
				;カズフェル合体開放。
				FLAG:(10000 + [[キャラ:카즈펠]]) = 1
				
				CALL MESSAGE_WINDOW_D, "카즈펠", "ど、どうして？/私にはまだやることが……/＞人々を、千年王国へ導かなければいけないのに！"
				CALL MESSAGE_WINDOW_D, "", "＞倒れたカズフェルが인간の姿に戻っている……/＞見るからに重体だ/＞このまま放っておけばどちらにしろ死ぬだろう"
				CALL INPUT_SELECT_D, "どうする？/[0]とどめを刺し亡骸を見せしめにする /[1]持ち帰って奴隷にする"
				
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "카즈펠", "いや、いや、いや……！/待って、わたし、まだ、なにも……/ヒッ"
					CALL MESSAGE_WINDOW_D, "", "＞당신は刎ねた소녀の首を袋に詰め、/＞動かなくなった体を割れた展望台から下に落とした"
					CALL MESSAGE_WINDOW_D, "", "＞……おや？　血だまりの中に、マジック아이템が落ちている"
					;정신내성반지
					CALL GET_ITEM,5068,1
					CALL MESSAGE_WINDOW_D, "", "/＞耐정신のリングを拾った/" , , , , , , , , , "CENTER"
					
					CFLAG:MASTER:善悪치 -= 16
					CFLAG:MASTER:秩混치 -= 16
				ELSEIF RESULT == 1
					CALL MESSAGE_WINDOW_D, "카즈펠", "さ、触らないで、いやっ……！/ファントムの性奴隷なんてっ……神の教えに、反する！/殺して！　殺しなさいっ、嫌ああああ！　むぐっ"
					CALL MESSAGE_WINDOW_D, "", "＞半魔か？　転生体か？　데빌시프터か？/＞なんにせよ面白い"
					CALL MESSAGE_WINDOW_D, "", "＞당신は身動きの取れなくなったカズフェルに猿ぐつわを噛ませると/＞縛って死体袋に捻じ込んだ"
					CALL MESSAGE_WINDOW_D, "","＞奴隷　カズフェルを손に入れた"
					
					CALL ADD_NEW_COMPANION,[[キャラ:카즈펠]],0
					IF RESULT == 1
						;都合のいい人型になってもらおう。날개根はそのままで
						;이형が良い人は合体で作ってね
						TALENT:(RESULT:1):인간화 = 1
						TALENT:(RESULT:1):발 = 1
						TALENT:(RESULT:1):절벽 = 0
						TALENT:(RESULT:1):푸른피부 = 0
						
						;妥協で半魔
						;……に、しようと思ったら、これCOMPに入っちゃうんだよね！　忘れてた！！！
						;解釈違いです！！！　カズちゃんのファンやめます！！！
						;といういきさつが（머리の中で）あり인간になりました。しかたないね
						;このとおり行き当たりばったりにやってるので何か不具合があれば適当に変えてくだち
						ABL:(RESULT:1):종족 = 0
						CSTR:(RESULT:1):종족명 = 천사
						;無難に이능자に
						TALENT:(RESULT:1):이능자 = 1
						
						;とりあえず옷
						CFLAG:(RESULT:1):모자 = 0
						CFLAG:(RESULT:1):옷 = 318
						CFLAG:(RESULT:1):속옷（상） = 501
						CFLAG:(RESULT:1):속옷（하） = 602
						CFLAG:(RESULT:1):양말 = 801
						CFLAG:(RESULT:1):신발 = 901
						
						BASE:(RESULT:1):LV = 30
						BASE:(RESULT:1):ＥＸＰ = 5*(29)*(31)*(30)/3*5/4
						;합계63で再설정
						BASE:(RESULT:1):힘 = 3
						BASE:(RESULT:1):지혜 = 20
						BASE:(RESULT:1):마력 = 12
						BASE:(RESULT:1):인내력 = 18
						BASE:(RESULT:1):속도 = 7
						BASE:(RESULT:1):운 = 3
						MAXBASE:(RESULT:1):LV = 30
						MAXBASE:(RESULT:1):힘 = 3
						MAXBASE:(RESULT:1):지혜 = 20
						MAXBASE:(RESULT:1):마력 = 12
						MAXBASE:(RESULT:1):인내력 = 18
						MAXBASE:(RESULT:1):속도 = 7
						MAXBASE:(RESULT:1):운 = 3
					
						;레벨を下げたので습득레벨も調整
						ABL:(RESULT:1):습득LV1 = 32
						ABL:(RESULT:1):습득LV2 = 35
						ABL:(RESULT:1):습득LV3 = 37
						ABL:(RESULT:1):습득LV4 = 39
						ABL:(RESULT:1):습득LV5 = 42
						
						;せっかくなので스킬추가、회전설법
						ABL:(RESULT:1):습득스킬6 = 1320
						ABL:(RESULT:1):습득LV6 = 48
						
					ENDIF
				ENDIF
				CALL MESSAGE_WINDOW_D, "魔女", "……あー、えっと/천사をやっつけてくれてありがとう"
				CALL MESSAGE_WINDOW_D, "魔女", "で、アンタ、아군なの？"
				CALL MESSAGE_WINDOW_D, "", "＞東京タワーの魔女は、深くかぶった후드の下から、ギ라기ラした視線を向けている"
				CALL MESSAGE_WINDOW_D, "", "＞당신は、눈的はメシア教徒の討伐であることを告げ、/＞とりあえず무기をその場に置いた"
				CALL MESSAGE_WINDOW_D, "魔女", "……ああ、なるほど/安く見られたから殺したってわけね。/実にヤクザなモノの考え方だけど、アタシは嫌いじゃないわ"
				CALL MESSAGE_WINDOW_D, "魔女", "ま、おかげで命拾いした。/何かお礼をしたいところだけど……"
				CALL MESSAGE_WINDOW_D, "魔女", "あ、そうだ/ターミナルの裏の、ヘソクリ部屋を開けとくわ/好きでしょ？　무기と防具とお金"
				CALL MESSAGE_WINDOW_D, "", "＞魔女はニン마리と笑って自分の背後を指さした……"
				
				;助けた
				던전フラグ:27:11 = 11
				CALL SET_TILE, 1 , 3 , 던전フラグ:27:11 , 11 , 3001
				
				
				RETURN 1
			ENDIF
	ENDSELECT
ELSEIF DA:(FLAG:現X):(FLAG:現Y) %10 == 9
	SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
		CASE 300
			CALL DUNGEON_TERMINAL
			RETURN 1
	ENDSELECT
ENDIF
RETURN 0





;=======================================================================
;エンカウント率
;=======================================================================
@ENCOUNT_RATE_27
SELECTCASE FLAG:現M
	CASE 0 , 1
		FLAG:エンカウント率 = FLAG:未遭遇歩数*5
	CASE 2 , 3
		FLAG:エンカウント率 = FLAG:未遭遇歩数*6
	CASE 4
		FLAG:エンカウント率 = FLAG:未遭遇歩数*5
	CASEELSE
		FLAG:エンカウント率 = FLAG:未遭遇歩数*5
ENDSELECT
;クリア後、メシア教が占拠した、またはファントムが占拠した場合、악마の出現は止まる
SIF FLAG:未遭遇歩数 < 5 || (던전フラグ:27:1 && (던전フラグ:27:11 == 13 || 던전フラグ:27:11 == 14))
	FLAG:エンカウント率 = 0
;=======================================================================
;필요레벨눈安
;권장LV 雑물고기최저LV 雑물고기最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_27
RETURN 30, 25, 34, 38
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_27
IF RAND:100 < FLAG:エンカウント率
	CALL ENEMY_TABLE
	IF RAND:3 == 1
		ABL:(CHARANUM-1):아이템2 = 1415
		ABL:(CHARANUM-1):입수확률2 = 8
	ELSEIF RAND:2 == 1
		ABL:(CHARANUM-1):아이템2 = 1416
		ABL:(CHARANUM-1):입수확률2 = 8
	ELSE
		ABL:(CHARANUM-1):아이템2 = 1417
		ABL:(CHARANUM-1):입수확률2 = 8
	ENDIF
	
	RETURN 1
ELSE
	FLAG:未遭遇歩数 += 1
	RETURN 0
ENDIF
;=======================================================================
;적の종족の종류数
;RETURN X でXが종류の数になります
;あまりいろんなのが混ざっているとCOOPがとりにくくなったり
;적の공격속성が多くなる傾向にあるので、
;종류の数は1・2종류を主体に時々3종류くらいを기본にするのが望ましいと思われます
;=======================================================================
@CLASS_NUM_27
SELECTCASE FLAG:現M
	CASE 0 , 1
		SELECTCASE RAND:100
			CASE IS < 50
				RETURN 1
			CASEELSE
				RETURN 1
		ENDSELECT
	CASE 2 , 3
		SELECTCASE RAND:100
			CASE IS < 50
				RETURN 2
			CASEELSE
				RETURN 3
		ENDSELECT
	CASE 4
		SELECTCASE RAND:100
			CASE IS < 35
				RETURN 1
			CASEELSE
				RETURN 2
		ENDSELECT
ENDSELECT

;=======================================================================
;적の総数
;ARGは出現する적の종류です
;RAND(X, Y)はX～Y-1のうちのどれかになるRANDです
;なお、ここで帰った数字は下限を종족数、上限を10として自動的に調整されます
;=======================================================================
@ENEMY_NUM_27, ARG
SELECTCASE FLAG:現M
	CASE 0 , 1
		;1~3あるいは2~5
		RETURN RAND(ARG, ARG*2+2)
	CASE 1 , 2
		;1~4あるいは2~6
		RETURN RAND(ARG, ARG*2+3)
	CASE 4
		;1~4あるいは2~6
		RETURN RAND(ARG, ARG*2+3)
ENDSELECT
;=======================================================================
;적の종류
;=======================================================================
@ENEMY_27, ARG
SELECTCASE FLAG:現M
	;タワー周辺とタワービル
	CASE 0 , 1
		;クリアフラグが立っておらず、かつメシア教を潰しに来た場合、2/3で천사＆メシア教徒が出る
		IF 던전フラグ:27:1 < 1 && RAND:3 > 0 && 이벤트フラグ:49:0 == 3
			SELECTCASE RAND:100
				CASE IS < 20
					;20%で
					;RETURN [登場악마のキャラ番号], LV　となっています
					RETURN [[キャラ:프린시펄리티]],28
				CASE IS < 35
					;15%で
					RETURN [[キャラ:아크엔젤]],28
				CASE IS < 50
					;15%で
					RETURN [[キャラ:파워]],31
				CASE IS < 65
					;15%で
					RETURN [[キャラ:홀리고스트]],26
				CASE IS < 74
					;9%で
					RETURN [[キャラ:파워]],34
				CASE IS < 83
					;9%で
					RETURN [[キャラ:메이거스]],30
				CASE IS < 92
					;9%で
					RETURN [[キャラ:듀나미스]],31
				CASE IS < 100
					;8%で
					RETURN [[キャラ:템플나이트]],28
			ENDSELECT
		ELSE
			SELECTCASE RAND:100
				CASE IS < 20
					;20%で
					;RETURN [登場악마のキャラ番号], LV　となっています
					RETURN [[キャラ:엘프]],27
				CASE IS < 35
					;15%で
					RETURN [[キャラ:밴시]],27
				CASE IS < 50
					;15%で
					RETURN [[キャラ:포르투나]],27
				CASE IS < 65
					;15%で
					RETURN [[キャラ:뮤턴트]],29
				CASE IS < 74
					;9%で
					RETURN [[キャラ:사라시나히메]],28
				CASE IS < 83
					;9%で
					RETURN [[キャラ:고르곤]],29
				CASE IS < 92
					;9%で
					;こんなところで湧いて来るなと言われればその通りだ……
					RETURN [[キャラ:오르트로스]],30
				CASE IS < 100
					;8%で
					RETURN [[キャラ:웬디고]],28
			ENDSELECT
		ENDIF
	CASE 2 , 3
		;クリアフラグが立っておらず、かつメシア教を潰しに来た場合、2/3で천사＆メシア教徒が出る
		IF 던전フラグ:27:1 < 1 && RAND:3 > 0 && 이벤트フラグ:49:0 == 3
			SELECTCASE RAND:100
				CASE IS < 20
					;20%で
					;RETURN [登場악마のキャラ番号], LV　となっています
					RETURN [[キャラ:프린시펄리티]],28
				CASE IS < 35
					;15%で
					RETURN [[キャラ:아크엔젤]],28
				CASE IS < 50
					;15%で
					RETURN [[キャラ:파워]],31
				CASE IS < 65
					;15%で
					RETURN [[キャラ:홀리고스트]],26
				CASE IS < 74
					;9%で
					RETURN [[キャラ:파워]],34
				CASE IS < 83
					;9%で
					RETURN [[キャラ:메이거스]],30
				CASE IS < 92
					;9%で
					RETURN [[キャラ:듀나미스]],31
				CASE IS < 100
					;8%で
					RETURN [[キャラ:템플나이트]],28
			ENDSELECT
		ELSE
			SELECTCASE RAND:100
				CASE IS < 20
					;20%で
					;RETURN [登場악마のキャラ番号], LV　となっています
					RETURN [[キャラ:엘프]],27
				CASE IS < 35
					;15%で
					RETURN [[キャラ:밴시]],27
				CASE IS < 50
					;15%で
					RETURN [[キャラ:포르투나]],26
				CASE IS < 65
					;15%で
					RETURN [[キャラ:뮤턴트]],29
				CASE IS < 74
					;9%で
					RETURN [[キャラ:사라시나히메]],28
				CASE IS < 83
					;9%で
					RETURN [[キャラ:고르곤]],29
				CASE IS < 92
					;9%で
					;こんなところで湧いて来るなと言われればその通りだ……
					RETURN [[キャラ:오르트로스]],30
				CASE IS < 100
					;8%で
					RETURN [[キャラ:웬디고]],28
			ENDSELECT
		ENDIF
	CASE 4
		SELECTCASE RAND:100
			CASE IS < 10
				;10%で픽시랭크１
				RETURN [[キャラ:픽시]],7
			CASE IS < 20
				;10%で하피랭크１
				RETURN [[キャラ:하피]],7
			CASE IS < 30
				;10%で좀비쨩랭크１
				RETURN [[キャラ:좀비쨩]],7
			CASE IS < 40
				;10%で아프사라스랭크1
				RETURN [[キャラ:아프사라스]],7
			CASE IS < 50
				;10%で픽시랭크２
				RETURN [[キャラ:픽시]],9
			CASE IS < 60
				;10%で춍춍랭크１
				RETURN [[キャラ:춍춍]],7
			CASE IS < 70
				;10%で노커랭크1
				RETURN [[キャラ:노커]],7
			CASE IS < 80
				;10%で좀비군
				RETURN [[キャラ:좀비군]],7
			CASE IS < 90
				;10%で코볼트
				RETURN [[キャラ:코볼트]],7
			CASE IS < 100
				;10%で화백
				RETURN [[キャラ:화백]],7
		ENDSELECT
ENDSELECT


;=======================================================================
;宝箱の中身
;=======================================================================
@TREASURE_27
#LOCALSIZE 3
;宝箱のフラグ管理用変数の番号
LOCAL = FLAG:現M + 70
;そのマップの何番눈の宝箱か
LOCAL:1 = (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100

;/10はIDを10で割る。つまり、下一桁をなくして、二桁눈と三桁눈を二桁の数字として取り出している
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	;マップ番号*100+そのマップで何番눈の宝箱かを示す数値でどの宝箱かを判別します。
	;例えば0の場合、0版のマップの0番눈の宝箱であることを表しています。
	CASE 0
		;@GET_TREASURE,아이템番号 , 입수個数 , 던전ナンバー , 開けた時に操作する変数の番号 , 変数に立てるビット
		;[[아이템:외상약]]は_Rename.csvによって1001番が置換されて渡されます。これは외상약の아이템番号です。
		;そしてその個数が1個、던전ナンバーは宝箱あけるときはよその던전をあけることがないだろうのでFLAG:現던전が無難です
		;LOCALはこの場合マップ番号の0+70で70が代入されています。そして、LOCAL:1にはこの宝箱がこのマップで何番눈の宝箱か、つまり0が入っています
		;このように記述すると、宝箱を開けた場合던전フラグ:27(에코빌딩の番号):70 の0番눈のビットが立ちます。
		;MAPをつくるときにこの宝箱は던전フラグ:27(에코빌딩):70の0番눈のビットが立っていない時しか置かないことになってるので、宝箱を開けるとこれで消えます
		;CALL GET_TREASURE, [[아이템:외상약]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 1
		;CALL GET_TREASURE, [[아이템:스킬카드【산바람】]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
		;DA:(FLAG:現X):(FLAG:現Y) = 24
	;百の位が1になりました。
	;これで以下の二つの宝箱はマップ番号1＝タワービルの0番눈の宝箱という事になります
	CASE 100
		CALL GET_TREASURE, [[아이템:스킬카드【마하・아쿠에스】]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 200
		;クリアフラグが立った後だと略奪済み
		IF 던전フラグ:27:1
			CALL MESSAGE_WINDOW_D, "", "＞ん？　何かありそうだったが、ガラクタしか入っていない"
		ELSE
			CALL GET_TREASURE, [[아이템:스킬카드【기가온】]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
		ENDIF
	CASE 201
		;クリアフラグが立った後だと略奪済み
		IF 던전フラグ:27:1
			CALL MESSAGE_WINDOW_D, "", "＞ん？　何かありそうだったが、ガラクタしか入っていない"
		ELSE
			CALL GET_TREASURE, [[아이템:전투식량MRE]] , 5 , FLAG:現던전, LOCAL , LOCAL:1
		ENDIF
	CASE 202
		;クリアフラグが立った後だと略奪済み
		IF 던전フラグ:27:1
			CALL MESSAGE_WINDOW_D, "", "＞ん？　何かありそうだったが、ガラクタしか入っていない"
		ELSE
			CALL GET_TREASURE, [[아이템:핵열내성반지]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
		ENDIF
	CASE 203
		CALL GET_TREASURE, [[아이템:힘의향]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 204
		CALL GET_TREASURE, [[아이템:스킬카드【다무도라】]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 205
		CALL GET_TREASURE, [[아이템:삼절곤]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 205
		;罠箱
		;@GET_TREASURE_TRAP , 罠の종류 , ダメージ量or확률 , 相性番号 , 던전ナンバー , 開けた時に操作する変数の番号 , 変数に立てるビット
		;第一引数が"ＨＰ"か"ＭＰ"なら최대値に対する第二引数％の割合ダメージを、
		;バッド스테이터스名であれば第二引数％の확률でそのバッド스테이터스になります。この場合、第三引数の番号の相性に対する내성で確率が変化します
		;この箱は아군全員のHPを40%減らす罠です。
		CALL GET_TREASURE_TRAP, "ＨＰ", 40 , GET_TYPE_NUM("만능") , FLAG:現던전, LOCAL , LOCAL:1
	CASE 300
		CALL GET_TREASURE, [[아이템:청홍검]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 301
		CALL GET_TREASURE, [[아이템:레이디스메일]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 302
		;@GET_TREASURE_MONEY ,￥or마카 , 입수額 , 던전ナンバー , 開けた時に操作する変数の番号 , 変数に立てるビット
		;第一引数が0なら￥、1なら마카を입수します
		;この宝箱には￥1000が入っています
		CALL GET_TREASURE_MONEY, 1 , 500 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 303
		CALL GET_TREASURE, [[아이템:무적의미니]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
ENDSELECT
RETURN 1

;=======================================================================
;階段置き場
;=======================================================================
;上り階段処理
@UPSTAIRS_27
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
;	;IDで分岐
;			;@DUNGEON_UPSTAIRS_ID , 階段を進んだ先のマップ番号 , 移動先のタイルのID
;			;２Ｆ＝マップ番号1番の0番눈の下り階段 = 1 * 1000 + 0 * 10 + 7 = 1007へと飛ぶ
;	;メインデッキ上り階段
	CASE 200
			CALL DUNGEON_UPSTAIRS_ID, 3 , 3007
	CASE 201
			CALL DUNGEON_UPSTAIRS_ID, 3 , 3017
	CASEELSE
			CALL DUNGEON_UPSTAIRS_ID, FLAG:現M+1 , (FLAG:現M + 1) * 1000 + 7
ENDSELECT

RETURN 1

;下り階段処理
@DOWNSTAIRS_27
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
;	;IDで分岐
;			;@DUNGEON_UPSTAIRS_ID , 階段を進んだ先のマップ番号 , 移動先のタイルのID
;			;２Ｆ＝マップ番号1番の0番눈の下り階段 = 1 * 1000 + 0 * 10 + 7 = 1007へと飛ぶ
;	;トップデッキ下り階段
	CASE 300
			CALL DUNGEON_DOWNSTAIRS_ID, 2 , 2006
	CASE 301
			CALL DUNGEON_DOWNSTAIRS_ID, 2 , 2016
	CASEELSE
			CALL DUNGEON_DOWNSTAIRS_ID, FLAG:現M-1 , (FLAG:現M - 1) * 1000 + 6
ENDSELECT
RETURN 1

;=======================================================================
;エレベーター定義
;=======================================================================
;ARGはそのエレベーターのタイル
@DUNGEON_ELEVATOR_27, ARG
;RESULT:1～5にエレベータが存在するマップの番号を代入し、RESULTS:1～5には표시したい명칭を代入、RETURNでは-1を返しておく
RESULT:1 = 0
RESULT:2 = 1
RESULT:3 = 2
RESULT:4 = 3
RESULT:5 = 4
RESULTS:1 = １Ｆ
RESULTS:2 = ２Ｆ
RESULTS:3 = ３Ｆ
RESULTS:4 = ４Ｆ
RESULTS:5 = ５Ｆ
RETURN -1

;=======================================================================
;윤간참가악마
;=======================================================================
@DUNGEON_RAPE_DEVIL_27
;랜덤にどの악마が出るか決定
;RETURN CSV番号 , 人数 , 레벨
SELECTCASE RAND:3
	CASE 0
		RETURN [[キャラ:엘프]] , 3 + RAND:10 , CSVBASE([[キャラ:엘프]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:고르곤]] , 3 + RAND:10 , CSVBASE([[キャラ:고르곤]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:오르트로스]] , 3 + RAND:10 , CSVBASE([[キャラ:오르트로스]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT

;=======================================================================
;ボス戦ACTEND이벤트
;=======================================================================
@EVENT_BATTLE_ACTEND_DUNGEON27
;東京タワーの魔女はHP50％未満でミサイルをﾌﾞｯﾊﾟするように
IF NO:(CHARANUM-1) == [[キャラ:도쿄타워의마녀]] && ABL:(CHARANUM-1):스킬7 != 0 && 現HP割合(CHARANUM-1) < 50
	PRINTFORML 
	PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━━━━━━┓
	PRINTFORML ┃消し飛んでも、恨まないでよ　　　　　　　　　┃
	PRINTFORML ┗━━━━━━━━━━━━━━━━━━━━━━┛
	PRINTFORMW ＞魔女はミサイルを装填した
	;마린카린と뉴클리어미사일を交換
	ABL:(CHARANUM-1):스킬3 = [[스킬:뉴클리어미사일]]
	;도루미나、라이트블래스트を封印
	ABL:(CHARANUM-1):스킬6 = 0
	ABL:(CHARANUM-1):스킬7 = 0
	CFLAG:(CHARANUM-1):行動횟수 = 3
;カズフェルはHP50％未満で行動変化
ELSEIF NO:(CHARANUM-1) == [[キャラ:카즈펠]] && ABL:(CHARANUM-1):스킬4 != [[스킬:유혹의안개]] && 現HP割合(CHARANUM-1) < 50
	PRINTFORML 
	PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━━━━━━┓
	PRINTFORML ┃愚かなり、デビル・서머너！　　　　　　　　┃
	PRINTFORML ┃それだけの힘を持ちながら、　　　　　　　　　┃
	PRINTFORML ┃神の御心を妨げるなんて！　　　　　　　　　　┃
	PRINTFORMW ┗━━━━━━━━━━━━━━━━━━━━━━┛
	;마린카린⇒유혹의안개
	ABL:(CHARANUM-1):스킬4 = [[스킬:유혹의안개]]
	
;カズフェルはHP15％未満で発狂
ELSEIF NO:(CHARANUM-1) == [[キャラ:카즈펠]] && ABL:(CHARANUM-1):스킬1 != [[스킬:회전설법]] && 現HP割合(CHARANUM-1) < 15
	PRINTFORML 
	PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━━━━━━┓
	PRINTFORML ┃なぜ、なぜ刃を向けるのです……！？　　　　　┃
	PRINTFORML ┃私はただ、人をより良い方向へ　　　　　　　　┃
	PRINTFORML ┃導いてあげたいだけなのに……！　　　　　　　┃
	PRINTFORMW ┗━━━━━━━━━━━━━━━━━━━━━━┛
	;고양의노래⇒회전설법
	ABL:(CHARANUM-1):스킬1 = [[스킬:회전설법]]
	;라쿠・카쟈⇒削除
	ABL:(CHARANUM-1):스킬5 = 0
	
ENDIF	






;※SCP-191 Cyborg Child　の帰属
;本パッチに含まれる【SCP-191 Cyborg Child】に関する一切の記述は"DrClef"作【SCP-191 Cyborg Child】に基づきます。
;http://ja.scp-wiki.net/scp-191
;
;また、ライセンスはクリエイティブコモンズ　표시-継承3.0ライセンス(CC BY-SA 3.0)に準拠します。
;https://creativecommons.org/licenses/by-sa/3.0/deed.ja
;
;---以下ライセンス条項日本語版---
;표시　継承 3.0 非移植 (CC BY-SA 3.0)
;これは人が読んでわかりやすいようにしたライセンスの要約です。(ライセンスの代わりになるものではありません。) 免責条項.
;
;【당신は以下の조건に従う限り、自由に：】
;
;共有
;　どのようなメ디아やフォーマットでも資料を複製したり、再配布できます。
;翻案
;　マテリアルをリミックスしたり、改変したり、別の作品のベースにしたりできます。
;営利눈的も含め、どのような눈的でも。
;
;당신がライセンスの조건に従っている限り、許諾者がこれらの自由を取り消すことはできません。
;
;【당신の従うべき조건は以下の通りです】
;표시
;　당신は 適切なクレジットを표시し、ライセンスへのリンクを提供し、변경があったらその旨を示さなければなりません。これらは合理的であればどのような方法で行っても構いませんが、許諾者が당신や당신の利用行為を支持していると示唆するような方法は除きます。
;
;継承
;　もし당신がこの資料をリミックスしたり、改変したり、加工した場合には、당신は당신の貢献部分を元の作品と同じライセンスの下に頒布しなければなりません。
;
;추가的な制約は課せません
;　당신は、このライセンスが他の者に許諾することを法的に制限するようないかなる法的規定も技術的손段 も適用してはなりません。
;
;【ご注意：】
;당신は、資料の中でパブリック・ドメインに属している部分に関して、あるいは당신の利用が著作権法上の権利制限規定にもとづく場合には、ライセンスの規定に従う필요はありません。
;
;保証は提供されていません。ライセンスは당신の利用に필요な全ての許諾を与えないかも知れません。例えば、パブリシティ権、肖像権、人格権 などの他の諸権利は당신がどのように資料を利用するかを制限することがあります。
